{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 7.5, "shaped_reward_min": 6, "shaped_reward_max": 9, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 2.0, "onion_pickup_agent_0_min": 1, "onion_pickup_agent_0_max": 3, "onion_pickup_agent_1_mean": 7.0, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 2.0, "useful_onion_pickup_agent_0_min": 1, "useful_onion_pickup_agent_0_max": 3, "useful_onion_pickup_agent_1_mean": 7.0, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 1.5, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 2, "onion_drop_agent_1_mean": 4.5, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.5, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 1, "potting_onion_agent_1_mean": 2.0, "potting_onion_agent_1_min": 1, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.5, "dish_pickup_agent_0_min": 2, "dish_pickup_agent_0_max": 3, "dish_pickup_agent_1_mean": 4.5, "dish_pickup_agent_1_min": 4, "dish_pickup_agent_1_max": 5, "useful_dish_pickup_agent_0_mean": 0.0, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 0, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 1.5, "dish_drop_agent_0_min": 1, "dish_drop_agent_0_max": 2, "dish_drop_agent_1_mean": 4.5, "dish_drop_agent_1_min": 4, "dish_drop_agent_1_max": 5, "useful_dish_drop_agent_0_mean": 1.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 2, "useful_dish_drop_agent_1_mean": 3.5, "useful_dish_drop_agent_1_min": 3, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.5, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 1, "optimal_onion_potting_agent_1_mean": 2.0, "optimal_onion_potting_agent_1_min": 1, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.5, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 1, "viable_onion_potting_agent_1_mean": 2.0, "viable_onion_potting_agent_1_min": 1, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": -0.357877254486084, "policy_loss": 5.196221172809601e-05, "vf_loss": 2.477907180786133, "vf_explained_var": 0.0001665055751800537, "kl": 6.113413633102027e-07, "entropy": 1.7908855676651, "entropy_coeff": 0.20000000298023224, "model": {}}}}, "num_env_steps_sampled": 800, "num_env_steps_trained": 800, "num_agent_steps_sampled": 1600, "num_agent_steps_trained": 1600}, "sampler_results": {"episode_reward_max": 28.709221303931002, "episode_reward_min": 28.422129090891687, "episode_reward_mean": 28.565675197411345, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 14.211064545445844}, "policy_reward_max": {"ppo": 14.354610651965501}, "policy_reward_mean": {"ppo": 14.282837598705672}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 7.5, "shaped_reward_min": 6, "shaped_reward_max": 9, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 2.0, "onion_pickup_agent_0_min": 1, "onion_pickup_agent_0_max": 3, "onion_pickup_agent_1_mean": 7.0, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 2.0, "useful_onion_pickup_agent_0_min": 1, "useful_onion_pickup_agent_0_max": 3, "useful_onion_pickup_agent_1_mean": 7.0, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 1.5, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 2, "onion_drop_agent_1_mean": 4.5, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 0, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.5, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 1, "potting_onion_agent_1_mean": 2.0, "potting_onion_agent_1_min": 1, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.5, "dish_pickup_agent_0_min": 2, "dish_pickup_agent_0_max": 3, "dish_pickup_agent_1_mean": 4.5, "dish_pickup_agent_1_min": 4, "dish_pickup_agent_1_max": 5, "useful_dish_pickup_agent_0_mean": 0.0, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 0, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 1.5, "dish_drop_agent_0_min": 1, "dish_drop_agent_0_max": 2, "dish_drop_agent_1_mean": 4.5, "dish_drop_agent_1_min": 4, "dish_drop_agent_1_max": 5, "useful_dish_drop_agent_0_mean": 1.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 2, "useful_dish_drop_agent_1_mean": 3.5, "useful_dish_drop_agent_1_min": 3, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.0, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 0, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.0, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 0, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.0, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 0, "optimal_onion_potting_agent_0_mean": 0.5, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 1, "optimal_onion_potting_agent_1_mean": 2.0, "optimal_onion_potting_agent_1_min": 1, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.5, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 1, "viable_onion_potting_agent_1_mean": 2.0, "viable_onion_potting_agent_1_min": 1, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687], "episode_lengths": [400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3488721621319298, "mean_inference_ms": 1.3389935654200864, "mean_action_processing_ms": 0.06945570756433608, "mean_env_wait_ms": 0.7073173808694332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 28.709221303931002, "episode_reward_min": 28.422129090891687, "episode_reward_mean": 28.565675197411345, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 14.211064545445844}, "policy_reward_max": {"ppo": 14.354610651965501}, "policy_reward_mean": {"ppo": 14.282837598705672}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687], "episode_lengths": [400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3488721621319298, "mean_inference_ms": 1.3389935654200864, "mean_action_processing_ms": 0.06945570756433608, "mean_env_wait_ms": 0.7073173808694332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 1600, "num_agent_steps_trained": 1600, "num_env_steps_sampled": 800, "num_env_steps_trained": 800, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 800, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 1600, "timers": {"training_iteration_time_ms": 2159.971, "learn_time_ms": 158.257, "learn_throughput": 5055.076}, "counters": {"num_env_steps_sampled": 800, "num_env_steps_trained": 800, "num_agent_steps_sampled": 1600, "num_agent_steps_trained": 1600}, "done": false, "episodes_total": 2, "training_iteration": 1, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-00", "timestamp": 1721659200, "time_this_iter_s": 2.1615567207336426, "time_total_s": 2.1615567207336426, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 2.1615567207336426, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 7.633333333333333, "ram_util_percent": 29.133333333333336, "gpu_util_percent0": 0.01, "vram_util_percent0": 0.09086468001954079}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.25, "shaped_reward_min": 6, "shaped_reward_max": 14, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 3.25, "onion_pickup_agent_0_min": 1, "onion_pickup_agent_0_max": 8, "onion_pickup_agent_1_mean": 4.75, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.25, "useful_onion_pickup_agent_0_min": 1, "useful_onion_pickup_agent_0_max": 8, "useful_onion_pickup_agent_1_mean": 4.75, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 2.75, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 7, "onion_drop_agent_1_mean": 2.75, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.25, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 1, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.5, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 1, "potting_onion_agent_1_mean": 1.5, "potting_onion_agent_1_min": 1, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 4.5, "dish_pickup_agent_0_min": 1, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 4.0, "dish_pickup_agent_1_min": 3, "dish_pickup_agent_1_max": 5, "useful_dish_pickup_agent_0_mean": 0.25, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 3.75, "dish_drop_agent_0_min": 1, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 3.5, "dish_drop_agent_1_min": 2, "dish_drop_agent_1_max": 5, "useful_dish_drop_agent_0_mean": 1.75, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 2.0, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.75, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.25, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.5, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.5, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 1, "optimal_onion_potting_agent_1_mean": 1.5, "optimal_onion_potting_agent_1_min": 1, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.5, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 1, "viable_onion_potting_agent_1_mean": 1.5, "viable_onion_potting_agent_1_min": 1, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": -0.35687100887298584, "policy_loss": 2.7271918952465057e-05, "vf_loss": 2.6699271202087402, "vf_explained_var": -0.0005648136138916016, "kl": 3.3538677257638483e-07, "entropy": 1.7906014919281006, "entropy_coeff": 0.19946666061878204, "model": {}}}}, "num_env_steps_sampled": 1600, "num_env_steps_trained": 1600, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 3200}, "sampler_results": {"episode_reward_max": 33.331799913033535, "episode_reward_min": 1.4943441886631916, "episode_reward_mean": 22.989373624129854, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.7471720943315958}, "policy_reward_max": {"ppo": 16.665899956516768}, "policy_reward_mean": {"ppo": 11.494686812064927}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.25, "shaped_reward_min": 6, "shaped_reward_max": 14, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 3.25, "onion_pickup_agent_0_min": 1, "onion_pickup_agent_0_max": 8, "onion_pickup_agent_1_mean": 4.75, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.25, "useful_onion_pickup_agent_0_min": 1, "useful_onion_pickup_agent_0_max": 8, "useful_onion_pickup_agent_1_mean": 4.75, "useful_onion_pickup_agent_1_min": 2, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 2.75, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 7, "onion_drop_agent_1_mean": 2.75, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.25, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 1, "useful_onion_drop_agent_1_mean": 0.0, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 0, "potting_onion_agent_0_mean": 0.5, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 1, "potting_onion_agent_1_mean": 1.5, "potting_onion_agent_1_min": 1, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 4.5, "dish_pickup_agent_0_min": 1, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 4.0, "dish_pickup_agent_1_min": 3, "dish_pickup_agent_1_max": 5, "useful_dish_pickup_agent_0_mean": 0.25, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 3.75, "dish_drop_agent_0_min": 1, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 3.5, "dish_drop_agent_1_min": 2, "dish_drop_agent_1_max": 5, "useful_dish_drop_agent_0_mean": 1.75, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 2.0, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.75, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.25, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.5, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.5, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 1, "optimal_onion_potting_agent_1_mean": 1.5, "optimal_onion_potting_agent_1_min": 1, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.5, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 1, "viable_onion_potting_agent_1_mean": 1.5, "viable_onion_potting_agent_1_min": 1, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535], "episode_lengths": [400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36145699047244695, "mean_inference_ms": 1.3249457927834745, "mean_action_processing_ms": 0.06904881136391626, "mean_env_wait_ms": 0.6327661327151304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 33.331799913033535, "episode_reward_min": 1.4943441886631916, "episode_reward_mean": 22.989373624129854, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.7471720943315958}, "policy_reward_max": {"ppo": 16.665899956516768}, "policy_reward_mean": {"ppo": 11.494686812064927}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535], "episode_lengths": [400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36145699047244695, "mean_inference_ms": 1.3249457927834745, "mean_action_processing_ms": 0.06904881136391626, "mean_env_wait_ms": 0.6327661327151304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 3200, "num_env_steps_sampled": 1600, "num_env_steps_trained": 1600, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 1600, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 3200, "timers": {"training_iteration_time_ms": 1961.307, "learn_time_ms": 93.042, "learn_throughput": 8598.222}, "counters": {"num_env_steps_sampled": 1600, "num_env_steps_trained": 1600, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 3200}, "done": false, "episodes_total": 4, "training_iteration": 2, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-03", "timestamp": 1721659203, "time_this_iter_s": 3.08138370513916, "time_total_s": 5.242940425872803, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 5.242940425872803, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 3.775, "ram_util_percent": 29.125000000000004, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.09086468001954079}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 7.166666666666667, "shaped_reward_min": 3, "shaped_reward_max": 14, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 3.1666666666666665, "onion_pickup_agent_0_min": 1, "onion_pickup_agent_0_max": 8, "onion_pickup_agent_1_mean": 4.166666666666667, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 2.5, "useful_onion_pickup_agent_0_min": 1, "useful_onion_pickup_agent_0_max": 8, "useful_onion_pickup_agent_1_mean": 3.8333333333333335, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 2.1666666666666665, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 7, "onion_drop_agent_1_mean": 2.5, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.5, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 1, "useful_onion_drop_agent_1_mean": 0.3333333333333333, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 1, "potting_onion_agent_0_mean": 0.6666666666666666, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 1, "potting_onion_agent_1_mean": 1.0, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 4.333333333333333, "dish_pickup_agent_0_min": 1, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 4.0, "dish_pickup_agent_1_min": 3, "dish_pickup_agent_1_max": 5, "useful_dish_pickup_agent_0_mean": 0.16666666666666666, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 3.8333333333333335, "dish_drop_agent_0_min": 1, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 3.6666666666666665, "dish_drop_agent_1_min": 2, "dish_drop_agent_1_max": 5, "useful_dish_drop_agent_0_mean": 2.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.8333333333333333, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.5, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.16666666666666666, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.3333333333333333, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.6666666666666666, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 1, "optimal_onion_potting_agent_1_mean": 1.0, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.6666666666666666, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 1, "viable_onion_potting_agent_1_mean": 1.0, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": -0.355942040681839, "policy_loss": 8.810311555862427e-06, "vf_loss": 1.9535493850708008, "vf_explained_var": 0.00039896368980407715, "kl": 1.7114906825099752e-07, "entropy": 1.7902791500091553, "entropy_coeff": 0.19893333315849304, "model": {}}}}, "num_env_steps_sampled": 2400, "num_env_steps_trained": 2400, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 4800}, "sampler_results": {"episode_reward_max": 33.331799913033535, "episode_reward_min": 1.4943441886631916, "episode_reward_mean": 15.871520374484723, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.7471720943315958}, "policy_reward_max": {"ppo": 16.665899956516768}, "policy_reward_mean": {"ppo": 7.935760187242361}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 7.166666666666667, "shaped_reward_min": 3, "shaped_reward_max": 14, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 3.1666666666666665, "onion_pickup_agent_0_min": 1, "onion_pickup_agent_0_max": 8, "onion_pickup_agent_1_mean": 4.166666666666667, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 2.5, "useful_onion_pickup_agent_0_min": 1, "useful_onion_pickup_agent_0_max": 8, "useful_onion_pickup_agent_1_mean": 3.8333333333333335, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 2.1666666666666665, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 7, "onion_drop_agent_1_mean": 2.5, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.5, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 1, "useful_onion_drop_agent_1_mean": 0.3333333333333333, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 1, "potting_onion_agent_0_mean": 0.6666666666666666, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 1, "potting_onion_agent_1_mean": 1.0, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 4.333333333333333, "dish_pickup_agent_0_min": 1, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 4.0, "dish_pickup_agent_1_min": 3, "dish_pickup_agent_1_max": 5, "useful_dish_pickup_agent_0_mean": 0.16666666666666666, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.0, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 0, "dish_drop_agent_0_mean": 3.8333333333333335, "dish_drop_agent_0_min": 1, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 3.6666666666666665, "dish_drop_agent_1_min": 2, "dish_drop_agent_1_max": 5, "useful_dish_drop_agent_0_mean": 2.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.8333333333333333, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.5, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.16666666666666666, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.3333333333333333, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.6666666666666666, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 1, "optimal_onion_potting_agent_1_mean": 1.0, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.6666666666666666, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 1, "viable_onion_potting_agent_1_mean": 1.0, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458], "episode_lengths": [400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3647841506128575, "mean_inference_ms": 1.3261870629374168, "mean_action_processing_ms": 0.06945800207847892, "mean_env_wait_ms": 0.5926470857253331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 33.331799913033535, "episode_reward_min": 1.4943441886631916, "episode_reward_mean": 15.871520374484723, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.7471720943315958}, "policy_reward_max": {"ppo": 16.665899956516768}, "policy_reward_mean": {"ppo": 7.935760187242361}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458], "episode_lengths": [400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3647841506128575, "mean_inference_ms": 1.3261870629374168, "mean_action_processing_ms": 0.06945800207847892, "mean_env_wait_ms": 0.5926470857253331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 4800, "num_env_steps_sampled": 2400, "num_env_steps_trained": 2400, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 2400, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 4800, "timers": {"training_iteration_time_ms": 1914.265, "learn_time_ms": 72.454, "learn_throughput": 11041.419}, "counters": {"num_env_steps_sampled": 2400, "num_env_steps_trained": 2400, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 4800}, "done": false, "episodes_total": 6, "training_iteration": 3, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-05", "timestamp": 1721659205, "time_this_iter_s": 1.8225374221801758, "time_total_s": 7.0654778480529785, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 7.0654778480529785, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 7.400000000000001, "ram_util_percent": 29.166666666666668, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.09086468001954079}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 7.125, "shaped_reward_min": 0, "shaped_reward_max": 14, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 3.75, "onion_pickup_agent_0_min": 1, "onion_pickup_agent_0_max": 8, "onion_pickup_agent_1_mean": 4.375, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.25, "useful_onion_pickup_agent_0_min": 1, "useful_onion_pickup_agent_0_max": 8, "useful_onion_pickup_agent_1_mean": 4.125, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 2.625, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 7, "onion_drop_agent_1_mean": 2.875, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.375, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 1, "useful_onion_drop_agent_1_mean": 0.25, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 1, "potting_onion_agent_0_mean": 0.625, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 1, "potting_onion_agent_1_mean": 0.875, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 4.0, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 3.75, "dish_pickup_agent_1_min": 1, "dish_pickup_agent_1_max": 5, "useful_dish_pickup_agent_0_mean": 0.125, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.125, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 3.625, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 3.375, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 5, "useful_dish_drop_agent_0_mean": 2.125, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.875, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.5, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.125, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.25, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.625, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 1, "optimal_onion_potting_agent_1_mean": 0.875, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.625, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 1, "viable_onion_potting_agent_1_mean": 0.875, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": -0.354952335357666, "policy_loss": -1.9706785678863525e-06, "vf_loss": 2.9228572845458984, "vf_explained_var": -7.486343383789062e-05, "kl": 1.1226074292380872e-07, "entropy": 1.7905375957489014, "entropy_coeff": 0.19840000569820404, "model": {}}}}, "num_env_steps_sampled": 3200, "num_env_steps_trained": 3200, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 6400}, "sampler_results": {"episode_reward_max": 67.00028467367346, "episode_reward_min": 1.4943441886631916, "episode_reward_mean": 24.692650854201915, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.7471720943315958}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 12.346325427100957}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 7.125, "shaped_reward_min": 0, "shaped_reward_max": 14, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 3.75, "onion_pickup_agent_0_min": 1, "onion_pickup_agent_0_max": 8, "onion_pickup_agent_1_mean": 4.375, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.25, "useful_onion_pickup_agent_0_min": 1, "useful_onion_pickup_agent_0_max": 8, "useful_onion_pickup_agent_1_mean": 4.125, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 2.625, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 7, "onion_drop_agent_1_mean": 2.875, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.375, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 1, "useful_onion_drop_agent_1_mean": 0.25, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 1, "potting_onion_agent_0_mean": 0.625, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 1, "potting_onion_agent_1_mean": 0.875, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 4.0, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 3.75, "dish_pickup_agent_1_min": 1, "dish_pickup_agent_1_max": 5, "useful_dish_pickup_agent_0_mean": 0.125, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.125, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 3.625, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 3.375, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 5, "useful_dish_drop_agent_0_mean": 2.125, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.875, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.0, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 0, "soup_pickup_agent_1_mean": 0.5, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.125, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.0, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 0, "soup_drop_agent_1_mean": 0.25, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 0.625, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 1, "optimal_onion_potting_agent_1_mean": 0.875, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.625, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 1, "viable_onion_potting_agent_1_mean": 0.875, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36737102187388204, "mean_inference_ms": 1.3323641248332603, "mean_action_processing_ms": 0.07017175231873832, "mean_env_wait_ms": 0.567612720103559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 67.00028467367346, "episode_reward_min": 1.4943441886631916, "episode_reward_mean": 24.692650854201915, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.7471720943315958}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 12.346325427100957}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36737102187388204, "mean_inference_ms": 1.3323641248332603, "mean_action_processing_ms": 0.07017175231873832, "mean_env_wait_ms": 0.567612720103559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 6400, "num_env_steps_sampled": 3200, "num_env_steps_trained": 3200, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 3200, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 6400, "timers": {"training_iteration_time_ms": 1907.826, "learn_time_ms": 61.298, "learn_throughput": 13051.007}, "counters": {"num_env_steps_sampled": 3200, "num_env_steps_trained": 3200, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 6400}, "done": false, "episodes_total": 8, "training_iteration": 4, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-09", "timestamp": 1721659209, "time_this_iter_s": 3.1103813648223877, "time_total_s": 10.175859212875366, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 10.175859212875366, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 9.725000000000001, "ram_util_percent": 29.125, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.09086468001954079}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.0, "shaped_reward_min": 0, "shaped_reward_max": 17, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.7, "onion_pickup_agent_0_min": 1, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 4.7, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.1, "useful_onion_pickup_agent_0_min": 1, "useful_onion_pickup_agent_0_max": 9, "useful_onion_pickup_agent_1_mean": 4.3, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.2, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 8, "onion_drop_agent_1_mean": 3.2, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.5, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 2, "useful_onion_drop_agent_1_mean": 0.2, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 1, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 3.7, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 4.1, "dish_pickup_agent_1_min": 1, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.1, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.1, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 3.3, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 3.8, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.8, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 2.1, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.4, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.5, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.1, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.4, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.3, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": -0.35398465394973755, "policy_loss": -1.2699980288743973e-05, "vf_loss": 2.827298641204834, "vf_explained_var": 0.0005816221237182617, "kl": 1.0388028925945036e-07, "entropy": 1.7903708219528198, "entropy_coeff": 0.19786666333675385, "model": {}}}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 67.00028467367346, "episode_reward_min": 1.4943441886631916, "episode_reward_mean": 23.1893298212699, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.7471720943315958}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 11.59466491063495}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.0, "shaped_reward_min": 0, "shaped_reward_max": 17, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.7, "onion_pickup_agent_0_min": 1, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 4.7, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.1, "useful_onion_pickup_agent_0_min": 1, "useful_onion_pickup_agent_0_max": 9, "useful_onion_pickup_agent_1_mean": 4.3, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.2, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 8, "onion_drop_agent_1_mean": 3.2, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.5, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 2, "useful_onion_drop_agent_1_mean": 0.2, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 1, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 3.7, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 4.1, "dish_pickup_agent_1_min": 1, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.1, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.1, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 3.3, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 3.8, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.8, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 2.1, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.4, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.5, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.1, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.4, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.3, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36906306259707183, "mean_inference_ms": 1.3359055905558683, "mean_action_processing_ms": 0.07062018939174904, "mean_env_wait_ms": 0.5499221693937235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 67.00028467367346, "episode_reward_min": 1.4943441886631916, "episode_reward_mean": 23.1893298212699, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.7471720943315958}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 11.59466491063495}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36906306259707183, "mean_inference_ms": 1.3359055905558683, "mean_action_processing_ms": 0.07062018939174904, "mean_env_wait_ms": 0.5499221693937235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 4000, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 1888.977, "learn_time_ms": 54.316, "learn_throughput": 14728.73}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 10, "training_iteration": 5, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-10", "timestamp": 1721659210, "time_this_iter_s": 1.8166160583496094, "time_total_s": 11.992475271224976, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 11.992475271224976, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 8.7, "ram_util_percent": 29.1, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.09086468001954079}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.083333333333334, "shaped_reward_min": 0, "shaped_reward_max": 17, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.5, "onion_pickup_agent_0_min": 1, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.166666666666667, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.9166666666666665, "useful_onion_pickup_agent_0_min": 1, "useful_onion_pickup_agent_0_max": 9, "useful_onion_pickup_agent_1_mean": 4.833333333333333, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.0833333333333335, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 8, "onion_drop_agent_1_mean": 3.5833333333333335, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.5, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 2, "useful_onion_drop_agent_1_mean": 0.16666666666666666, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 1, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8333333333333334, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 3.5833333333333335, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 3.5, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.08333333333333333, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.08333333333333333, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 3.0, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 3.25, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.5, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.75, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.5, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.4166666666666667, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.08333333333333333, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.5, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.25, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8333333333333334, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8333333333333334, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": -0.3529576361179352, "policy_loss": -1.0863877832889557e-06, "vf_loss": 3.175144672393799, "vf_explained_var": 4.979968070983887e-05, "kl": 1.3041538693414623e-07, "entropy": 1.7902400493621826, "entropy_coeff": 0.19733333587646484, "model": {}}}}, "num_env_steps_sampled": 4800, "num_env_steps_trained": 4800, "num_agent_steps_sampled": 9600, "num_agent_steps_trained": 9600}, "sampler_results": {"episode_reward_max": 67.00028467367346, "episode_reward_min": 1.4943441886631916, "episode_reward_mean": 19.618425833510766, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.7471720943315958}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 9.809212916755383}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.083333333333334, "shaped_reward_min": 0, "shaped_reward_max": 17, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.5, "onion_pickup_agent_0_min": 1, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.166666666666667, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.9166666666666665, "useful_onion_pickup_agent_0_min": 1, "useful_onion_pickup_agent_0_max": 9, "useful_onion_pickup_agent_1_mean": 4.833333333333333, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.0833333333333335, "onion_drop_agent_0_min": 1, "onion_drop_agent_0_max": 8, "onion_drop_agent_1_mean": 3.5833333333333335, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.5, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 2, "useful_onion_drop_agent_1_mean": 0.16666666666666666, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 1, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8333333333333334, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 3.5833333333333335, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 3.5, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.08333333333333333, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.08333333333333333, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 3.0, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 3.25, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.5, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.75, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.5, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.4166666666666667, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.08333333333333333, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.5, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.25, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8333333333333334, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8333333333333334, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3699283432190288, "mean_inference_ms": 1.3382486976666328, "mean_action_processing_ms": 0.07093691043745108, "mean_env_wait_ms": 0.5365768027060316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 67.00028467367346, "episode_reward_min": 1.4943441886631916, "episode_reward_mean": 19.618425833510766, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.7471720943315958}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 9.809212916755383}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3699283432190288, "mean_inference_ms": 1.3382486976666328, "mean_action_processing_ms": 0.07093691043745108, "mean_env_wait_ms": 0.5365768027060316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 9600, "num_agent_steps_trained": 9600, "num_env_steps_sampled": 4800, "num_env_steps_trained": 4800, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 4800, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 9600, "timers": {"training_iteration_time_ms": 1875.734, "learn_time_ms": 50.512, "learn_throughput": 15837.897}, "counters": {"num_env_steps_sampled": 4800, "num_env_steps_trained": 4800, "num_agent_steps_sampled": 9600, "num_agent_steps_trained": 9600}, "done": false, "episodes_total": 12, "training_iteration": 6, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-14", "timestamp": 1721659214, "time_this_iter_s": 3.1027753353118896, "time_total_s": 15.095250606536865, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 15.095250606536865, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 7.040000000000001, "ram_util_percent": 29.1, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.09086468001954079}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 7.357142857142857, "shaped_reward_min": 0, "shaped_reward_max": 17, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.5, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 4.928571428571429, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.0, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 9, "useful_onion_pickup_agent_1_mean": 4.642857142857143, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.0714285714285716, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 8, "onion_drop_agent_1_mean": 3.5, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.42857142857142855, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 2, "useful_onion_drop_agent_1_mean": 0.14285714285714285, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 1, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7142857142857143, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 3.5714285714285716, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 3.5714285714285716, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.07142857142857142, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.07142857142857142, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 3.0, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 3.2857142857142856, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.5714285714285714, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.8571428571428572, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.42857142857142855, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.35714285714285715, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.07142857142857142, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.42857142857142855, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.21428571428571427, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7142857142857143, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7142857142857143, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": -0.3521459698677063, "policy_loss": -1.2998469173908234e-05, "vf_loss": 2.5643420219421387, "vf_explained_var": 0.00032967329025268555, "kl": 9.904839970431567e-08, "entropy": 1.7905967235565186, "entropy_coeff": 0.19679999351501465, "model": {}}}}, "num_env_steps_sampled": 5600, "num_env_steps_trained": 5600, "num_agent_steps_sampled": 11200, "num_agent_steps_trained": 11200}, "sampler_results": {"episode_reward_max": 67.00028467367346, "episode_reward_min": 0.0, "episode_reward_mean": 18.84594564950149, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 9.422972824750746}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 7.357142857142857, "shaped_reward_min": 0, "shaped_reward_max": 17, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.5, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 4.928571428571429, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.0, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 9, "useful_onion_pickup_agent_1_mean": 4.642857142857143, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.0714285714285716, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 8, "onion_drop_agent_1_mean": 3.5, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.42857142857142855, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 2, "useful_onion_drop_agent_1_mean": 0.14285714285714285, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 1, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7142857142857143, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 3.5714285714285716, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 3.5714285714285716, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.07142857142857142, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.07142857142857142, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 1, "dish_drop_agent_0_mean": 3.0, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 3.2857142857142856, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.5714285714285714, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.8571428571428572, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.42857142857142855, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.35714285714285715, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.07142857142857142, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.42857142857142855, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.21428571428571427, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7142857142857143, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7142857142857143, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37044191948340144, "mean_inference_ms": 1.3411665144953306, "mean_action_processing_ms": 0.0712114141141675, "mean_env_wait_ms": 0.5261826207006916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 67.00028467367346, "episode_reward_min": 0.0, "episode_reward_mean": 18.84594564950149, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 9.422972824750746}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37044191948340144, "mean_inference_ms": 1.3411665144953306, "mean_action_processing_ms": 0.0712114141141675, "mean_env_wait_ms": 0.5261826207006916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 11200, "num_agent_steps_trained": 11200, "num_env_steps_sampled": 5600, "num_env_steps_trained": 5600, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 5600, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 11200, "timers": {"training_iteration_time_ms": 1874.335, "learn_time_ms": 47.754, "learn_throughput": 16752.363}, "counters": {"num_env_steps_sampled": 5600, "num_env_steps_trained": 5600, "num_agent_steps_sampled": 11200, "num_agent_steps_trained": 11200}, "done": false, "episodes_total": 14, "training_iteration": 7, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-16", "timestamp": 1721659216, "time_this_iter_s": 1.8697068691253662, "time_total_s": 16.96495747566223, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 16.96495747566223, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 4.2, "ram_util_percent": 29.05, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.09086468001954079}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.375, "shaped_reward_min": 0, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.8125, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.0625, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.1875, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 9, "useful_onion_pickup_agent_1_mean": 4.5625, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.25, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 8, "onion_drop_agent_1_mean": 3.6875, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.5, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 2, "useful_onion_drop_agent_1_mean": 0.4375, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 3, "potting_onion_agent_0_mean": 1.125, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.6875, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 3.25, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 3.4375, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.0625, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.1875, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.75, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 3.0625, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.4375, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.625, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.375, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.4375, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.125, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.375, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.1875, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.125, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.6875, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.125, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.6875, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": -0.35098540782928467, "policy_loss": 2.5387853384017944e-06, "vf_loss": 3.450840950012207, "vf_explained_var": 0.00013363361358642578, "kl": 1.2949732308698003e-07, "entropy": 1.7900803089141846, "entropy_coeff": 0.19626666605472565, "model": {}}}}, "num_env_steps_sampled": 6400, "num_env_steps_trained": 6400, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800}, "sampler_results": {"episode_reward_max": 67.00028467367346, "episode_reward_min": 0.0, "episode_reward_mean": 18.656257162306886, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 9.328128581153441}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.375, "shaped_reward_min": 0, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 4.8125, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.0625, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.1875, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 9, "useful_onion_pickup_agent_1_mean": 4.5625, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.25, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 8, "onion_drop_agent_1_mean": 3.6875, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.5, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 2, "useful_onion_drop_agent_1_mean": 0.4375, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 3, "potting_onion_agent_0_mean": 1.125, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.6875, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 3.25, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 3.4375, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.0625, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.1875, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.75, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 3.0625, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.4375, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.625, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.375, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.4375, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.125, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.375, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.1875, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.125, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.6875, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.125, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.6875, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37083751468282494, "mean_inference_ms": 1.3426055753435637, "mean_action_processing_ms": 0.07137389741719218, "mean_env_wait_ms": 0.5179375870921392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 67.00028467367346, "episode_reward_min": 0.0, "episode_reward_mean": 18.656257162306886, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 9.328128581153441}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37083751468282494, "mean_inference_ms": 1.3426055753435637, "mean_action_processing_ms": 0.07137389741719218, "mean_env_wait_ms": 0.5179375870921392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800, "num_env_steps_sampled": 6400, "num_env_steps_trained": 6400, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 6400, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 12800, "timers": {"training_iteration_time_ms": 1865.772, "learn_time_ms": 47.535, "learn_throughput": 16829.809}, "counters": {"num_env_steps_sampled": 6400, "num_env_steps_trained": 6400, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800}, "done": false, "episodes_total": 16, "training_iteration": 8, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-19", "timestamp": 1721659219, "time_this_iter_s": 3.263200044631958, "time_total_s": 20.22815752029419, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 20.22815752029419, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 12.625000000000002, "ram_util_percent": 29.175, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.09086468001954079}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.88888888888889, "shaped_reward_min": 0, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.222222222222222, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.444444444444445, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.611111111111111, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 9, "useful_onion_pickup_agent_1_mean": 4.944444444444445, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.611111111111111, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 8, "onion_drop_agent_1_mean": 4.055555555555555, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.5, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 2, "useful_onion_drop_agent_1_mean": 0.4444444444444444, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 3, "potting_onion_agent_0_mean": 1.1111111111111112, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7777777777777778, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 3.0555555555555554, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 3.111111111111111, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.16666666666666666, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.16666666666666666, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.5555555555555554, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.7222222222222223, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.3333333333333333, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.4444444444444444, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.4444444444444444, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.3888888888888889, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.1111111111111111, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.4444444444444444, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.16666666666666666, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.1111111111111112, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7777777777777778, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.1111111111111112, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7777777777777778, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": -0.3502529263496399, "policy_loss": 3.308989107608795e-06, "vf_loss": 1.8979121446609497, "vf_explained_var": -0.0010952353477478027, "kl": 1.2987030117983522e-07, "entropy": 1.7904257774353027, "entropy_coeff": 0.19573333859443665, "model": {}}}}, "num_env_steps_sampled": 7200, "num_env_steps_trained": 7200, "num_agent_steps_sampled": 14400, "num_agent_steps_trained": 14400}, "sampler_results": {"episode_reward_max": 67.00028467367346, "episode_reward_min": 0.0, "episode_reward_mean": 19.981109641608004, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 9.990554820804}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.88888888888889, "shaped_reward_min": 0, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.222222222222222, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.444444444444445, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.611111111111111, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 9, "useful_onion_pickup_agent_1_mean": 4.944444444444445, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.611111111111111, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 8, "onion_drop_agent_1_mean": 4.055555555555555, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.5, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 2, "useful_onion_drop_agent_1_mean": 0.4444444444444444, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 3, "potting_onion_agent_0_mean": 1.1111111111111112, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7777777777777778, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 3.0555555555555554, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 3.111111111111111, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.16666666666666666, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.16666666666666666, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.5555555555555554, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.7222222222222223, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.3333333333333333, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.4444444444444444, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.4444444444444444, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.3888888888888889, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 2, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.1111111111111111, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.4444444444444444, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.16666666666666666, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 2, "optimal_onion_potting_agent_0_mean": 1.1111111111111112, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7777777777777778, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.1111111111111112, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7777777777777778, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3709744746481746, "mean_inference_ms": 1.3433261652185986, "mean_action_processing_ms": 0.07148244045592804, "mean_env_wait_ms": 0.511415769789773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 67.00028467367346, "episode_reward_min": 0.0, "episode_reward_mean": 19.981109641608004, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 9.990554820804}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3709744746481746, "mean_inference_ms": 1.3433261652185986, "mean_action_processing_ms": 0.07148244045592804, "mean_env_wait_ms": 0.511415769789773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 14400, "num_agent_steps_trained": 14400, "num_env_steps_sampled": 7200, "num_env_steps_trained": 7200, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 7200, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 14400, "timers": {"training_iteration_time_ms": 1858.532, "learn_time_ms": 45.603, "learn_throughput": 17542.559}, "counters": {"num_env_steps_sampled": 7200, "num_env_steps_trained": 7200, "num_agent_steps_sampled": 14400, "num_agent_steps_trained": 14400}, "done": false, "episodes_total": 18, "training_iteration": 9, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-21", "timestamp": 1721659221, "time_this_iter_s": 1.8054313659667969, "time_total_s": 22.033588886260986, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 22.033588886260986, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 6.766666666666666, "ram_util_percent": 29.233333333333334, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.09086468001954079}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.25, "shaped_reward_min": 0, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.2, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.45, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.4, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 9, "useful_onion_pickup_agent_1_mean": 4.95, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.6, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 8, "onion_drop_agent_1_mean": 4.05, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.65, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 2, "useful_onion_drop_agent_1_mean": 0.55, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 3, "potting_onion_agent_0_mean": 1.1, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.75, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 3.05, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.15, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.2, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.3, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.6, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.2, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.35, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.4, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.55, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.1, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.4, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.35, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 1.1, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.1, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": -0.34922388195991516, "policy_loss": 8.35023820400238e-06, "vf_loss": 2.074082136154175, "vf_explained_var": 0.00016248226165771484, "kl": 7.81873552568868e-08, "entropy": 1.7901620864868164, "entropy_coeff": 0.19519999623298645, "model": {}}}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 67.00028467367346, "episode_reward_min": 0.0, "episode_reward_mean": 19.44368754294508, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 9.72184377147254}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.25, "shaped_reward_min": 0, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.2, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.45, "onion_pickup_agent_1_min": 2, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.4, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 9, "useful_onion_pickup_agent_1_mean": 4.95, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.6, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 8, "onion_drop_agent_1_mean": 4.05, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.65, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 2, "useful_onion_drop_agent_1_mean": 0.55, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 3, "potting_onion_agent_0_mean": 1.1, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.75, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 3.05, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.15, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.2, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.3, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.6, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.2, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.35, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.4, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.55, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.1, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.4, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.35, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 1.1, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.1, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37091410339561715, "mean_inference_ms": 1.3434360332945734, "mean_action_processing_ms": 0.07153303100539744, "mean_env_wait_ms": 0.5060202697238729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 67.00028467367346, "episode_reward_min": 0.0, "episode_reward_mean": 19.44368754294508, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 9.72184377147254}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37091410339561715, "mean_inference_ms": 1.3434360332945734, "mean_action_processing_ms": 0.07153303100539744, "mean_env_wait_ms": 0.5060202697238729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 8000, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 1849.468, "learn_time_ms": 43.618, "learn_throughput": 18340.997}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 20, "training_iteration": 10, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-24", "timestamp": 1721659224, "time_this_iter_s": 3.0537610054016113, "time_total_s": 25.087349891662598, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 25.087349891662598, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 8.25, "ram_util_percent": 29.225, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.09086468001954079}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.772727272727273, "shaped_reward_min": 0, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.363636363636363, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.2727272727272725, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.5, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 9, "useful_onion_pickup_agent_1_mean": 4.7272727272727275, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.8181818181818183, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 8, "onion_drop_agent_1_mean": 3.9545454545454546, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.7272727272727273, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 3, "useful_onion_drop_agent_1_mean": 0.5909090909090909, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 3, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7727272727272727, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.772727272727273, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 3.0454545454545454, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.13636363636363635, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.18181818181818182, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.3636363636363638, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.590909090909091, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.3181818181818181, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.2272727272727273, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.36363636363636365, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.5909090909090909, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.09090909090909091, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.36363636363636365, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.36363636363636365, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7727272727272727, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7727272727272727, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": -0.3481767773628235, "policy_loss": -5.677808076143265e-06, "vf_loss": 3.4565558433532715, "vf_explained_var": 0.00022974610328674316, "kl": 3.4433053741622643e-08, "entropy": 1.79032564163208, "entropy_coeff": 0.19466666877269745, "model": {}}}}, "num_env_steps_sampled": 8800, "num_env_steps_trained": 8800, "num_agent_steps_sampled": 17600, "num_agent_steps_trained": 17600}, "sampler_results": {"episode_reward_max": 67.00028467367346, "episode_reward_min": 0.0, "episode_reward_mean": 20.8097560696625, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 10.40487803483125}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.772727272727273, "shaped_reward_min": 0, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.363636363636363, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.2727272727272725, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.5, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 9, "useful_onion_pickup_agent_1_mean": 4.7272727272727275, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.8181818181818183, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 8, "onion_drop_agent_1_mean": 3.9545454545454546, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.7272727272727273, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 3, "useful_onion_drop_agent_1_mean": 0.5909090909090909, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 3, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7727272727272727, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.772727272727273, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 3.0454545454545454, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.13636363636363635, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.18181818181818182, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.3636363636363638, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.590909090909091, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.3181818181818181, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.2272727272727273, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.36363636363636365, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.5909090909090909, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.09090909090909091, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.36363636363636365, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.36363636363636365, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7727272727272727, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7727272727272727, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37048598874720295, "mean_inference_ms": 1.3422289101426892, "mean_action_processing_ms": 0.07150093120137307, "mean_env_wait_ms": 0.5009364618553995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 67.00028467367346, "episode_reward_min": 0.0, "episode_reward_mean": 20.8097560696625, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 10.40487803483125}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37048598874720295, "mean_inference_ms": 1.3422289101426892, "mean_action_processing_ms": 0.07150093120137307, "mean_env_wait_ms": 0.5009364618553995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 17600, "num_agent_steps_trained": 17600, "num_env_steps_sampled": 8800, "num_env_steps_trained": 8800, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 8800, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 17600, "timers": {"training_iteration_time_ms": 1793.127, "learn_time_ms": 30.569, "learn_throughput": 26169.932}, "counters": {"num_env_steps_sampled": 8800, "num_env_steps_trained": 8800, "num_agent_steps_sampled": 17600, "num_agent_steps_trained": 17600}, "done": false, "episodes_total": 22, "training_iteration": 11, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-26", "timestamp": 1721659226, "time_this_iter_s": 1.6019649505615234, "time_total_s": 26.68931484222412, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 26.68931484222412, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 7.7, "ram_util_percent": 29.2, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.09086468001954079}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.75, "shaped_reward_min": 0, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.5, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.375, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.375, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 9, "useful_onion_pickup_agent_1_mean": 4.583333333333333, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.9583333333333335, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.041666666666667, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.7916666666666666, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.75, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.75, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.8333333333333335, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.16666666666666666, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.16666666666666666, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.3333333333333335, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.4166666666666665, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.2916666666666667, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.125, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.375, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.5416666666666666, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.08333333333333333, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.375, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.3333333333333333, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.75, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.75, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": -0.3472921848297119, "policy_loss": -3.9441511034965515e-06, "vf_loss": 2.117086887359619, "vf_explained_var": 0.0001806318759918213, "kl": 3.508400681084822e-08, "entropy": 1.7900066375732422, "entropy_coeff": 0.19413332641124725, "model": {}}}}, "num_env_steps_sampled": 9600, "num_env_steps_trained": 9600, "num_agent_steps_sampled": 19200, "num_agent_steps_trained": 19200}, "sampler_results": {"episode_reward_max": 67.00028467367346, "episode_reward_min": 0.0, "episode_reward_mean": 20.532593638366794, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 10.266296819183397}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.75, "shaped_reward_min": 0, "shaped_reward_max": 22, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.5, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 11, "onion_pickup_agent_1_mean": 5.375, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.375, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 9, "useful_onion_pickup_agent_1_mean": 4.583333333333333, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.9583333333333335, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 9, "onion_drop_agent_1_mean": 4.041666666666667, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.0, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.7916666666666666, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.75, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.75, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.8333333333333335, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.16666666666666666, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.16666666666666666, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.3333333333333335, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.4166666666666665, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.2916666666666667, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.125, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.375, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.5416666666666666, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.08333333333333333, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.375, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.3333333333333333, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.75, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.75, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36985189194556495, "mean_inference_ms": 1.3403190572401324, "mean_action_processing_ms": 0.07142428997646397, "mean_env_wait_ms": 0.49639612006981154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 67.00028467367346, "episode_reward_min": 0.0, "episode_reward_mean": 20.532593638366794, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 10.266296819183397}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36985189194556495, "mean_inference_ms": 1.3403190572401324, "mean_action_processing_ms": 0.07142428997646397, "mean_env_wait_ms": 0.49639612006981154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 19200, "num_agent_steps_trained": 19200, "num_env_steps_sampled": 9600, "num_env_steps_trained": 9600, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 9600, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 19200, "timers": {"training_iteration_time_ms": 1779.73, "learn_time_ms": 30.194, "learn_throughput": 26495.459}, "counters": {"num_env_steps_sampled": 9600, "num_env_steps_trained": 9600, "num_agent_steps_sampled": 19200, "num_agent_steps_trained": 19200}, "done": false, "episodes_total": 24, "training_iteration": 12, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-29", "timestamp": 1721659229, "time_this_iter_s": 2.843534231185913, "time_total_s": 29.532849073410034, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 29.532849073410034, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 5.95, "ram_util_percent": 29.2, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.09086468001954079}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.076923076923077, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.884615384615385, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.153846153846154, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.6923076923076925, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.423076923076923, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 4.269230769230769, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.8461538461538463, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.0384615384615385, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.7307692307692307, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 1.0769230769230769, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7307692307692307, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.6153846153846154, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.6923076923076925, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.19230769230769232, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.19230769230769232, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.1923076923076925, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.269230769230769, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.2307692307692308, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.0384615384615385, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.34615384615384615, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.5769230769230769, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.07692307692307693, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.34615384615384615, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.34615384615384615, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 1.0769230769230769, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7307692307692307, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0769230769230769, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7307692307692307, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": -0.34635093808174133, "policy_loss": -1.6992096789181232e-05, "vf_loss": 2.4371767044067383, "vf_explained_var": 0.0003031790256500244, "kl": 4.3415425921011774e-08, "entropy": 1.790173888206482, "entropy_coeff": 0.19359999895095825, "model": {}}}}, "num_env_steps_sampled": 10400, "num_env_steps_trained": 10400, "num_agent_steps_sampled": 20800, "num_agent_steps_trained": 20800}, "sampler_results": {"episode_reward_max": 67.00028467367346, "episode_reward_min": 0.0, "episode_reward_mean": 20.108866725206035, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 10.054433362603014}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.076923076923077, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.884615384615385, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.153846153846154, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.6923076923076925, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.423076923076923, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 4.269230769230769, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.8461538461538463, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.0384615384615385, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.7307692307692307, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 1.0769230769230769, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7307692307692307, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.6153846153846154, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.6923076923076925, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.19230769230769232, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.19230769230769232, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.1923076923076925, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.269230769230769, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.2307692307692308, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.0384615384615385, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.34615384615384615, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.5769230769230769, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.07692307692307693, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.34615384615384615, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.34615384615384615, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 1.0769230769230769, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7307692307692307, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0769230769230769, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7307692307692307, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3692298424261029, "mean_inference_ms": 1.3381813556843472, "mean_action_processing_ms": 0.07133329318940385, "mean_env_wait_ms": 0.4922887483201887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 67.00028467367346, "episode_reward_min": 0.0, "episode_reward_mean": 20.108866725206035, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 10.054433362603014}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3692298424261029, "mean_inference_ms": 1.3381813556843472, "mean_action_processing_ms": 0.07133329318940385, "mean_env_wait_ms": 0.4922887483201887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 20800, "num_agent_steps_trained": 20800, "num_env_steps_sampled": 10400, "num_env_steps_trained": 10400, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 10400, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 20800, "timers": {"training_iteration_time_ms": 1764.898, "learn_time_ms": 29.687, "learn_throughput": 26947.909}, "counters": {"num_env_steps_sampled": 10400, "num_env_steps_trained": 10400, "num_agent_steps_sampled": 20800, "num_agent_steps_trained": 20800}, "done": false, "episodes_total": 26, "training_iteration": 13, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-30", "timestamp": 1721659230, "time_this_iter_s": 1.6779065132141113, "time_total_s": 31.210755586624146, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 31.210755586624146, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 7.0, "ram_util_percent": 29.2, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.09086468001954079}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.75, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.857142857142857, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.107142857142857, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.535714285714286, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.357142857142857, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 4.285714285714286, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.75, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.1428571428571428, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.7857142857142857, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.75, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.5714285714285716, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.7142857142857144, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.21428571428571427, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.17857142857142858, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.1785714285714284, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.3214285714285716, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.1428571428571428, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.1071428571428572, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.32142857142857145, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.5357142857142857, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.07142857142857142, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.32142857142857145, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.32142857142857145, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.75, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.75, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": -0.34546178579330444, "policy_loss": -1.3559125363826752e-05, "vf_loss": 1.4082465171813965, "vf_explained_var": 0.0006583034992218018, "kl": 4.6576555945421205e-08, "entropy": 1.7899986505508423, "entropy_coeff": 0.19306667149066925, "model": {}}}}, "num_env_steps_sampled": 11200, "num_env_steps_trained": 11200, "num_agent_steps_sampled": 22400, "num_agent_steps_trained": 22400}, "sampler_results": {"episode_reward_max": 67.00028467367346, "episode_reward_min": 0.0, "episode_reward_mean": 18.789362950205206, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 9.394681475102603}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.75, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.857142857142857, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.107142857142857, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.535714285714286, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.357142857142857, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 4.285714285714286, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.75, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.1428571428571428, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.7857142857142857, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.75, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.5714285714285716, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.7142857142857144, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.21428571428571427, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.17857142857142858, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.1785714285714284, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.3214285714285716, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.1428571428571428, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.1071428571428572, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.32142857142857145, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.5357142857142857, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.07142857142857142, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.32142857142857145, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.32142857142857145, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.75, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.75, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36857113404292885, "mean_inference_ms": 1.3358501476656457, "mean_action_processing_ms": 0.07123193544278082, "mean_env_wait_ms": 0.48869456874807465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 67.00028467367346, "episode_reward_min": 0.0, "episode_reward_mean": 18.789362950205206, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 9.394681475102603}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36857113404292885, "mean_inference_ms": 1.3358501476656457, "mean_action_processing_ms": 0.07123193544278082, "mean_env_wait_ms": 0.48869456874807465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 22400, "num_agent_steps_trained": 22400, "num_env_steps_sampled": 11200, "num_env_steps_trained": 11200, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 11200, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 22400, "timers": {"training_iteration_time_ms": 1743.495, "learn_time_ms": 29.851, "learn_throughput": 26799.487}, "counters": {"num_env_steps_sampled": 11200, "num_env_steps_trained": 11200, "num_agent_steps_sampled": 22400, "num_agent_steps_trained": 22400}, "done": false, "episodes_total": 28, "training_iteration": 14, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-33", "timestamp": 1721659233, "time_this_iter_s": 2.863311290740967, "time_total_s": 34.07406687736511, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 34.07406687736511, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 16.375, "ram_util_percent": 29.25, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.09086468001954079}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.2, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.7, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.066666666666666, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.366666666666666, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.333333333333333, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 4.133333333333334, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.7, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.1333333333333333, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.8, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.6333333333333333, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.6666666666666665, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.23333333333333334, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.2, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.2333333333333334, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.2, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.0666666666666667, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.0666666666666667, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.3, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.5666666666666667, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.06666666666666667, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.3, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.3333333333333333, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 4.999999873689376e-05, "total_loss": -0.3445298671722412, "policy_loss": -9.405426681041718e-06, "vf_loss": 1.7987329959869385, "vf_explained_var": 0.0004630088806152344, "kl": 7.180441485843403e-08, "entropy": 1.7903411388397217, "entropy_coeff": 0.19253332912921906, "model": {}}}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 67.00028467367346, "episode_reward_min": 0.0, "episode_reward_mean": 19.2568488315927, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 9.628424415796347}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.2, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.7, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.066666666666666, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.366666666666666, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.333333333333333, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 4.133333333333334, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.7, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.1333333333333333, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.8, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.6333333333333333, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.6666666666666665, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.23333333333333334, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.2, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.2333333333333334, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.2, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.0666666666666667, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.0666666666666667, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.3, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.5666666666666667, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.06666666666666667, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.3, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.3333333333333333, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3680535115257161, "mean_inference_ms": 1.3341180957588088, "mean_action_processing_ms": 0.07116081121400272, "mean_env_wait_ms": 0.4857238562369937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 67.00028467367346, "episode_reward_min": 0.0, "episode_reward_mean": 19.2568488315927, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 33.50014233683673}, "policy_reward_mean": {"ppo": 9.628424415796347}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3680535115257161, "mean_inference_ms": 1.3341180957588088, "mean_action_processing_ms": 0.07116081121400272, "mean_env_wait_ms": 0.4857238562369937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 12000, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 1749.324, "learn_time_ms": 30.286, "learn_throughput": 26415.093}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 30, "training_iteration": 15, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-35", "timestamp": 1721659235, "time_this_iter_s": 1.8798596858978271, "time_total_s": 35.95392656326294, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 35.95392656326294, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 7.85, "ram_util_percent": 29.2, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.09086468001954079}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.40625, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.59375, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.125, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.34375, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.4375, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 4.0, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.75, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.0625, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.75, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.84375, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.625, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.65625, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.21875, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.1875, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.25, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.15625, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.0625, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.0, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.28125, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.59375, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.09375, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.28125, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.3125, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.84375, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.84375, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 4.999999873689376e-05, "total_loss": -0.3432384133338928, "policy_loss": 4.455447196960449e-06, "vf_loss": 4.6226115226745605, "vf_explained_var": 0.00021913647651672363, "kl": 1.6362925236990122e-07, "entropy": 1.790130853652954, "entropy_coeff": 0.19200000166893005, "model": {}}}}, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "sampler_results": {"episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.12157418099405, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.560787090497024}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.40625, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.59375, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.125, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.34375, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.4375, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 4.0, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.75, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.0625, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.75, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 1.0, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.84375, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.625, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.65625, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.21875, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.1875, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.25, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.15625, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.0625, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.0, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.28125, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.59375, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.09375, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.28125, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.3125, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 1.0, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.84375, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 1.0, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.84375, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36761190800882804, "mean_inference_ms": 1.332743692580114, "mean_action_processing_ms": 0.07110180788702952, "mean_env_wait_ms": 0.48305575304784404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.12157418099405, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.560787090497024}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36761190800882804, "mean_inference_ms": 1.332743692580114, "mean_action_processing_ms": 0.07110180788702952, "mean_env_wait_ms": 0.48305575304784404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 12800, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 25600, "timers": {"training_iteration_time_ms": 1748.408, "learn_time_ms": 29.76, "learn_throughput": 26881.825}, "counters": {"num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "done": false, "episodes_total": 32, "training_iteration": 16, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-38", "timestamp": 1721659238, "time_this_iter_s": 3.0802881717681885, "time_total_s": 39.03421473503113, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 39.03421473503113, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 6.7250000000000005, "ram_util_percent": 29.2, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.09086468001954079}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.352941176470589, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.4411764705882355, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.176470588235294, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.205882352941177, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.470588235294118, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.8823529411764706, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.7941176470588234, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.0294117647058822, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.7647058823529411, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.9705882352941176, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8529411764705882, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.7941176470588234, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.764705882352941, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.20588235294117646, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.20588235294117646, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.411764705882353, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.264705882352941, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.1764705882352942, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.0588235294117647, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.2647058823529412, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.5882352941176471, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.11764705882352941, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.2647058823529412, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.29411764705882354, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.9705882352941176, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8529411764705882, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9705882352941176, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8529411764705882, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 4.999999873689376e-05, "total_loss": -0.34258151054382324, "policy_loss": -5.3406693041324615e-06, "vf_loss": 2.293724298477173, "vf_explained_var": 3.007054328918457e-05, "kl": 8.871132450849473e-08, "entropy": 1.790419101715088, "entropy_coeff": 0.19146665930747986, "model": {}}}}, "num_env_steps_sampled": 13600, "num_env_steps_trained": 13600, "num_agent_steps_sampled": 27200, "num_agent_steps_trained": 27200}, "sampler_results": {"episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.398792441468657, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.699396220734329}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.352941176470589, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.4411764705882355, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.176470588235294, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.205882352941177, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.470588235294118, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.8823529411764706, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.7941176470588234, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.0294117647058822, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.7647058823529411, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.9705882352941176, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8529411764705882, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.7941176470588234, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.764705882352941, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.20588235294117646, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.20588235294117646, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.411764705882353, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.264705882352941, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.1764705882352942, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.0588235294117647, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.2647058823529412, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.5882352941176471, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.11764705882352941, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.2647058823529412, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.29411764705882354, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.9705882352941176, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8529411764705882, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9705882352941176, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8529411764705882, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36717738622795615, "mean_inference_ms": 1.3314528273429909, "mean_action_processing_ms": 0.07104458488637722, "mean_env_wait_ms": 0.48060171689074344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.398792441468657, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.699396220734329}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36717738622795615, "mean_inference_ms": 1.3314528273429909, "mean_action_processing_ms": 0.07104458488637722, "mean_env_wait_ms": 0.48060171689074344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 27200, "num_agent_steps_trained": 27200, "num_env_steps_sampled": 13600, "num_env_steps_trained": 13600, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 13600, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 27200, "timers": {"training_iteration_time_ms": 1734.715, "learn_time_ms": 29.121, "learn_throughput": 27471.343}, "counters": {"num_env_steps_sampled": 13600, "num_env_steps_trained": 13600, "num_agent_steps_sampled": 27200, "num_agent_steps_trained": 27200}, "done": false, "episodes_total": 34, "training_iteration": 17, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-40", "timestamp": 1721659240, "time_this_iter_s": 1.7377278804779053, "time_total_s": 40.77194261550903, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 40.77194261550903, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 8.0, "ram_util_percent": 29.2, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.09086468001954079}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.527777777777779, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.583333333333333, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.222222222222222, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.277777777777778, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.444444444444445, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 4.055555555555555, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.8055555555555554, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.1388888888888888, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.8055555555555556, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.9444444444444444, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8611111111111112, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.6666666666666665, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.7777777777777777, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.19444444444444445, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.25, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.2777777777777777, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.2777777777777777, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.1111111111111112, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.0555555555555556, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.3055555555555556, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.5833333333333334, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.1388888888888889, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.3055555555555556, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.2777777777777778, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.9444444444444444, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8611111111111112, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9444444444444444, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8611111111111112, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 4.999999873689376e-05, "total_loss": -0.3414611220359802, "policy_loss": -8.969567716121674e-06, "vf_loss": 3.132030963897705, "vf_explained_var": -0.00040346384048461914, "kl": 5.696037419511413e-08, "entropy": 1.7899723052978516, "entropy_coeff": 0.19093333184719086, "model": {}}}}, "num_env_steps_sampled": 14400, "num_env_steps_trained": 14400, "num_agent_steps_sampled": 28800, "num_agent_steps_trained": 28800}, "sampler_results": {"episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.1812932443934, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.5906466221967}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.527777777777779, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.583333333333333, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.222222222222222, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.277777777777778, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.444444444444445, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 4.055555555555555, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.8055555555555554, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.1388888888888888, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.8055555555555556, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.9444444444444444, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8611111111111112, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.6666666666666665, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.7777777777777777, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.19444444444444445, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.25, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.2777777777777777, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.2777777777777777, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.1111111111111112, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.0555555555555556, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.3055555555555556, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.5833333333333334, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.1388888888888889, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.3055555555555556, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.2777777777777778, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.9444444444444444, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8611111111111112, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9444444444444444, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8611111111111112, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36684996183337915, "mean_inference_ms": 1.33071664653101, "mean_action_processing_ms": 0.07102267045257807, "mean_env_wait_ms": 0.47861433294513667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.1812932443934, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.5906466221967}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36684996183337915, "mean_inference_ms": 1.33071664653101, "mean_action_processing_ms": 0.07102267045257807, "mean_env_wait_ms": 0.47861433294513667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 28800, "num_agent_steps_trained": 28800, "num_env_steps_sampled": 14400, "num_env_steps_trained": 14400, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 14400, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 28800, "timers": {"training_iteration_time_ms": 1750.53, "learn_time_ms": 27.439, "learn_throughput": 29155.735}, "counters": {"num_env_steps_sampled": 14400, "num_env_steps_trained": 14400, "num_agent_steps_sampled": 28800, "num_agent_steps_trained": 28800}, "done": false, "episodes_total": 36, "training_iteration": 18, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-44", "timestamp": 1721659244, "time_this_iter_s": 3.3236827850341797, "time_total_s": 44.09562540054321, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 44.09562540054321, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 4.6, "ram_util_percent": 29.2, "gpu_util_percent0": 0.045000000000000005, "vram_util_percent0": 0.09193331704934049}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.394736842105264, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.578947368421052, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.2105263157894735, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.2105263157894735, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.2631578947368425, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 4.026315789473684, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.8157894736842106, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.1842105263157894, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.9473684210526315, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.9473684210526315, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8157894736842105, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.5789473684210527, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.736842105263158, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.18421052631578946, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.2631578947368421, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.210526315789474, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.236842105263158, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.0526315789473684, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.0, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.2894736842105263, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.5789473684210527, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.13157894736842105, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.2894736842105263, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.2894736842105263, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.9473684210526315, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8157894736842105, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9473684210526315, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8157894736842105, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 4.999999873689376e-05, "total_loss": -0.34067922830581665, "policy_loss": 1.7713755369186401e-06, "vf_loss": 1.8440015316009521, "vf_explained_var": 0.0009441375732421875, "kl": 4.462723879328223e-08, "entropy": 1.7902592420578003, "entropy_coeff": 0.19040000438690186, "model": {}}}}, "num_env_steps_sampled": 15200, "num_env_steps_trained": 15200, "num_agent_steps_sampled": 30400, "num_agent_steps_trained": 30400}, "sampler_results": {"episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.8727014565008, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.936350728250398}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.394736842105264, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.578947368421052, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.2105263157894735, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.2105263157894735, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.2631578947368425, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 4.026315789473684, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.8157894736842106, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.1842105263157894, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.9473684210526315, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.9473684210526315, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8157894736842105, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.5789473684210527, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.736842105263158, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.18421052631578946, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.2631578947368421, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.210526315789474, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.236842105263158, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.0526315789473684, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.0, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.2894736842105263, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.5789473684210527, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.13157894736842105, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.2894736842105263, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.2894736842105263, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.9473684210526315, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8157894736842105, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9473684210526315, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8157894736842105, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.366668376368415, "mean_inference_ms": 1.330158295260956, "mean_action_processing_ms": 0.07101076096797423, "mean_env_wait_ms": 0.4768262126516748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.8727014565008, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.936350728250398}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.366668376368415, "mean_inference_ms": 1.330158295260956, "mean_action_processing_ms": 0.07101076096797423, "mean_env_wait_ms": 0.4768262126516748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 30400, "num_agent_steps_trained": 30400, "num_env_steps_sampled": 15200, "num_env_steps_trained": 15200, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 15200, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 30400, "timers": {"training_iteration_time_ms": 1755.978, "learn_time_ms": 27.455, "learn_throughput": 29138.139}, "counters": {"num_env_steps_sampled": 15200, "num_env_steps_trained": 15200, "num_agent_steps_sampled": 30400, "num_agent_steps_trained": 30400}, "done": false, "episodes_total": 38, "training_iteration": 19, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-46", "timestamp": 1721659246, "time_this_iter_s": 1.8643136024475098, "time_total_s": 45.95993900299072, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 45.95993900299072, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 9.033333333333333, "ram_util_percent": 29.266666666666666, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.09220810942843187}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.225, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.375, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.35, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.05, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.425, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.85, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.925, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.125, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.9, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.925, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.85, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.7, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.725, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.175, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.25, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.325, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.225, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.025, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.0, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.275, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.55, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.125, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.275, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.275, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.925, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.85, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.925, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.85, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 4.999999873689376e-05, "total_loss": -0.33971941471099854, "policy_loss": 1.858919858932495e-05, "vf_loss": 1.9839262962341309, "vf_explained_var": 0.00028210878372192383, "kl": 7.375985688895526e-08, "entropy": 1.7903953790664673, "entropy_coeff": 0.18986666202545166, "model": {}}}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.4822437715396, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.7411218857698}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.225, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.375, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.35, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.05, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.425, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.85, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.925, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.125, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.9, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.925, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.85, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.7, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.725, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.175, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.25, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.325, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.225, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.025, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.0, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.275, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.55, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.125, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.275, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.275, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.925, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.85, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.925, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.85, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3664711896150953, "mean_inference_ms": 1.3294045773937007, "mean_action_processing_ms": 0.07098605613266121, "mean_env_wait_ms": 0.47514702422879135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.4822437715396, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.7411218857698}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3664711896150953, "mean_inference_ms": 1.3294045773937007, "mean_action_processing_ms": 0.07098605613266121, "mean_env_wait_ms": 0.47514702422879135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 16000, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 1746.777, "learn_time_ms": 27.588, "learn_throughput": 28998.005}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 40, "training_iteration": 20, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-49", "timestamp": 1721659249, "time_this_iter_s": 2.7910358905792236, "time_total_s": 48.750974893569946, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 48.750974893569946, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 11.066666666666668, "ram_util_percent": 29.2, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.09220810942843187}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.047619047619047, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.285714285714286, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.285714285714286, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.9047619047619047, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.285714285714286, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.8095238095238093, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.8333333333333335, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.1904761904761905, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.9285714285714286, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.8809523809523809, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8571428571428571, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.7142857142857144, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.6904761904761907, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.16666666666666666, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.23809523809523808, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.3333333333333335, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.2142857142857144, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.0, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.2857142857142857, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.5238095238095238, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.11904761904761904, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.2619047619047619, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.2619047619047619, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.8809523809523809, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8571428571428571, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8809523809523809, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8571428571428571, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 4.999999873689376e-05, "total_loss": -0.3387678265571594, "policy_loss": -3.4421682357788086e-06, "vf_loss": 1.6659011840820312, "vf_explained_var": -0.00030475854873657227, "kl": 2.976631563456067e-08, "entropy": 1.7901283502578735, "entropy_coeff": 0.18933333456516266, "model": {}}}}, "num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600}, "sampler_results": {"episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.337584682614573, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.668792341307286}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 9.047619047619047, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.285714285714286, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.285714285714286, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.9047619047619047, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.285714285714286, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.8095238095238093, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.8333333333333335, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.1904761904761905, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.9285714285714286, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.8809523809523809, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8571428571428571, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.7142857142857144, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.6904761904761907, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.16666666666666666, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.23809523809523808, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.3333333333333335, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.2142857142857144, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.0, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.2857142857142857, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.5238095238095238, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.11904761904761904, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.2619047619047619, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.2619047619047619, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.8809523809523809, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8571428571428571, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8809523809523809, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8571428571428571, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36644789344066253, "mean_inference_ms": 1.3285007683409247, "mean_action_processing_ms": 0.07095363232268236, "mean_env_wait_ms": 0.47352077599959314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.337584682614573, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.668792341307286}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36644789344066253, "mean_inference_ms": 1.3285007683409247, "mean_action_processing_ms": 0.07095363232268236, "mean_env_wait_ms": 0.47352077599959314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600, "num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 16800, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 33600, "timers": {"training_iteration_time_ms": 1759.194, "learn_time_ms": 27.296, "learn_throughput": 29307.792}, "counters": {"num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600}, "done": false, "episodes_total": 42, "training_iteration": 21, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-50", "timestamp": 1721659250, "time_this_iter_s": 1.7308216094970703, "time_total_s": 50.48179650306702, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 50.48179650306702, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 8.3, "ram_util_percent": 29.2, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.09220810942843187}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.909090909090908, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.409090909090909, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.2272727272727275, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.090909090909091, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.25, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.9318181818181817, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.772727272727273, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.1363636363636365, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.8863636363636364, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.8863636363636364, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8636363636363636, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.727272727272727, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.727272727272727, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.1590909090909091, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.22727272727272727, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.340909090909091, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.25, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.9545454545454546, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.2727272727272727, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.5, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.11363636363636363, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.25, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.25, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.8863636363636364, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8636363636363636, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8863636363636364, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8636363636363636, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 4.999999873689376e-05, "total_loss": -0.3376868963241577, "policy_loss": -4.8745423555374146e-06, "vf_loss": 2.985870361328125, "vf_explained_var": 0.00016355514526367188, "kl": 3.7883996384380225e-08, "entropy": 1.790151596069336, "entropy_coeff": 0.18880000710487366, "model": {}}}}, "num_env_steps_sampled": 17600, "num_env_steps_trained": 17600, "num_agent_steps_sampled": 35200, "num_agent_steps_trained": 35200}, "sampler_results": {"episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.2106764866739, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.60533824333695}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.909090909090908, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.409090909090909, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.2272727272727275, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.090909090909091, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.25, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.9318181818181817, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.772727272727273, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.1363636363636365, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.8863636363636364, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.8863636363636364, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8636363636363636, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.727272727272727, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.727272727272727, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.1590909090909091, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.22727272727272727, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.340909090909091, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.25, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.9545454545454546, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.2727272727272727, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.5, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.11363636363636363, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.25, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.25, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.8863636363636364, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8636363636363636, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8863636363636364, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8636363636363636, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353, 1.635813875194458, 35.45539486864516], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764, 0.817906937597229, 0.817906937597229, 17.72769743432258, 17.72769743432258]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3663733967797548, "mean_inference_ms": 1.327572094374978, "mean_action_processing_ms": 0.07091941514844285, "mean_env_wait_ms": 0.4719768142786961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.2106764866739, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.60533824333695}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353, 1.635813875194458, 35.45539486864516], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764, 0.817906937597229, 0.817906937597229, 17.72769743432258, 17.72769743432258]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3663733967797548, "mean_inference_ms": 1.327572094374978, "mean_action_processing_ms": 0.07091941514844285, "mean_env_wait_ms": 0.4719768142786961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 35200, "num_agent_steps_trained": 35200, "num_env_steps_sampled": 17600, "num_env_steps_trained": 17600, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 17600, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 35200, "timers": {"training_iteration_time_ms": 1765.858, "learn_time_ms": 27.558, "learn_throughput": 29029.314}, "counters": {"num_env_steps_sampled": 17600, "num_env_steps_trained": 17600, "num_agent_steps_sampled": 35200, "num_agent_steps_trained": 35200}, "done": false, "episodes_total": 44, "training_iteration": 22, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-54", "timestamp": 1721659254, "time_this_iter_s": 3.218379020690918, "time_total_s": 53.700175523757935, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 53.700175523757935, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 8.8, "ram_util_percent": 29.174999999999997, "gpu_util_percent0": 0.23, "vram_util_percent0": 0.09645212506106497}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.58695652173913, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.239130434782608, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.239130434782608, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.9782608695652173, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.282608695652174, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.782608695652174, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.782608695652174, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.0869565217391304, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.8478260869565217, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.8478260869565217, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8478260869565217, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.782608695652174, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.717391304347826, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.15217391304347827, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.21739130434782608, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.4130434782608696, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.260869565217391, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.9130434782608695, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.2608695652173913, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.4782608695652174, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.10869565217391304, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.2391304347826087, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.2391304347826087, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.8478260869565217, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8478260869565217, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8478260869565217, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8478260869565217, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 4.999999873689376e-05, "total_loss": -0.3367532193660736, "policy_loss": 4.930654540657997e-06, "vf_loss": 2.6304116249084473, "vf_explained_var": 0.0007690191268920898, "kl": 4.701220035485676e-08, "entropy": 1.7901266813278198, "entropy_coeff": 0.18826666474342346, "model": {}}}}, "num_env_steps_sampled": 18400, "num_env_steps_trained": 18400, "num_agent_steps_sampled": 36800, "num_agent_steps_trained": 36800}, "sampler_results": {"episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.773243024237242, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.886621512118621}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.58695652173913, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.239130434782608, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.239130434782608, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.9782608695652173, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.282608695652174, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.782608695652174, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.782608695652174, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.0869565217391304, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.8478260869565217, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.8478260869565217, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8478260869565217, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.782608695652174, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.717391304347826, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.15217391304347827, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.21739130434782608, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.4130434782608696, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.260869565217391, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.9130434782608695, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.2608695652173913, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.4782608695652174, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.10869565217391304, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.2391304347826087, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.2391304347826087, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.8478260869565217, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8478260869565217, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8478260869565217, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8478260869565217, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353, 1.635813875194458, 35.45539486864516, 1.635813875194458, 66.66359982606707], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764, 0.817906937597229, 0.817906937597229, 17.72769743432258, 17.72769743432258, 0.817906937597229, 0.817906937597229, 33.331799913033535, 33.331799913033535]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3662989662809666, "mean_inference_ms": 1.3266945190868433, "mean_action_processing_ms": 0.07088655153524769, "mean_env_wait_ms": 0.47055123618316863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.773243024237242, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.886621512118621}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353, 1.635813875194458, 35.45539486864516, 1.635813875194458, 66.66359982606707], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764, 0.817906937597229, 0.817906937597229, 17.72769743432258, 17.72769743432258, 0.817906937597229, 0.817906937597229, 33.331799913033535, 33.331799913033535]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3662989662809666, "mean_inference_ms": 1.3266945190868433, "mean_action_processing_ms": 0.07088655153524769, "mean_env_wait_ms": 0.47055123618316863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 36800, "num_agent_steps_trained": 36800, "num_env_steps_sampled": 18400, "num_env_steps_trained": 18400, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 18400, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 36800, "timers": {"training_iteration_time_ms": 1774.705, "learn_time_ms": 27.818, "learn_throughput": 28758.173}, "counters": {"num_env_steps_sampled": 18400, "num_env_steps_trained": 18400, "num_agent_steps_sampled": 36800, "num_agent_steps_trained": 36800}, "done": false, "episodes_total": 46, "training_iteration": 23, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-56", "timestamp": 1721659256, "time_this_iter_s": 1.7703731060028076, "time_total_s": 55.47054862976074, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 55.47054862976074, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 8.649999999999999, "ram_util_percent": 29.2, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.10075720566682951}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.8125, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.229166666666667, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.166666666666667, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.9791666666666665, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.208333333333333, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.7083333333333335, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.75, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.0625, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.8541666666666666, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.8958333333333334, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8333333333333334, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.7291666666666665, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.7291666666666665, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.14583333333333334, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.22916666666666666, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.3541666666666665, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.25, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 0.9583333333333334, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.9166666666666666, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.2708333333333333, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.4791666666666667, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.125, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.25, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.22916666666666666, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.8958333333333334, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8333333333333334, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8958333333333334, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8333333333333334, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 4.999999873689376e-05, "total_loss": -0.33590465784072876, "policy_loss": 4.455447196960449e-06, "vf_loss": 1.1437873840332031, "vf_explained_var": 0.0030324459075927734, "kl": 1.1055258397618672e-07, "entropy": 1.7898976802825928, "entropy_coeff": 0.18773333728313446, "model": {}}}}, "num_env_steps_sampled": 19200, "num_env_steps_trained": 19200, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400}, "sampler_results": {"episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 22.29170458224803, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 11.145852291124015}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.8125, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.229166666666667, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.166666666666667, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.9791666666666665, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.208333333333333, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.7083333333333335, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.75, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.0625, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.8541666666666666, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.8958333333333334, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8333333333333334, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.7291666666666665, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.7291666666666665, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.14583333333333334, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.22916666666666666, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.3541666666666665, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.25, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 0.9583333333333334, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.9166666666666666, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.2708333333333333, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.4791666666666667, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.125, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.25, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.22916666666666666, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.8958333333333334, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8333333333333334, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8958333333333334, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8333333333333334, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353, 1.635813875194458, 35.45539486864516, 1.635813875194458, 66.66359982606707, 35.10084091995871, 33.331799913033535], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764, 0.817906937597229, 0.817906937597229, 17.72769743432258, 17.72769743432258, 0.817906937597229, 0.817906937597229, 33.331799913033535, 33.331799913033535, 17.550420459979357, 17.550420459979357, 16.665899956516768, 16.665899956516768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3662423187505821, "mean_inference_ms": 1.326011663398209, "mean_action_processing_ms": 0.0708661610538374, "mean_env_wait_ms": 0.4696533920930192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 22.29170458224803, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 11.145852291124015}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353, 1.635813875194458, 35.45539486864516, 1.635813875194458, 66.66359982606707, 35.10084091995871, 33.331799913033535], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764, 0.817906937597229, 0.817906937597229, 17.72769743432258, 17.72769743432258, 0.817906937597229, 0.817906937597229, 33.331799913033535, 33.331799913033535, 17.550420459979357, 17.550420459979357, 16.665899956516768, 16.665899956516768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3662423187505821, "mean_inference_ms": 1.326011663398209, "mean_action_processing_ms": 0.0708661610538374, "mean_env_wait_ms": 0.4696533920930192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400, "num_env_steps_sampled": 19200, "num_env_steps_trained": 19200, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 19200, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 38400, "timers": {"training_iteration_time_ms": 1811.061, "learn_time_ms": 27.85, "learn_throughput": 28725.429}, "counters": {"num_env_steps_sampled": 19200, "num_env_steps_trained": 19200, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400}, "done": false, "episodes_total": 48, "training_iteration": 24, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-40-59", "timestamp": 1721659259, "time_this_iter_s": 3.3491709232330322, "time_total_s": 58.819719552993774, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 58.819719552993774, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 8.1, "ram_util_percent": 29.225, "gpu_util_percent0": 0.005, "vram_util_percent0": 0.10075720566682951}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.96, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.34, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.1, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.1, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.18, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.76, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.74, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.06, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.82, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.94, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.78, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.72, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.14, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.24, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.4, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.2, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.9, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.28, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.48, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.14, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.26, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.22, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.94, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.94, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 4.999999873689376e-05, "total_loss": -0.334847092628479, "policy_loss": 1.6205012798309326e-07, "vf_loss": 2.8985142707824707, "vf_explained_var": 0.000267714262008667, "kl": 8.841190890507278e-08, "entropy": 1.7902623414993286, "entropy_coeff": 0.18719999492168427, "model": {}}}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 22.10850693509087, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 11.054253467545431}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.96, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.34, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.1, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.1, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.18, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.76, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.74, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.06, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.82, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.94, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.78, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.72, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.14, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.24, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.4, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.2, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.0, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.9, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.28, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.48, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.14, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.26, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.22, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.94, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.94, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353, 1.635813875194458, 35.45539486864516, 1.635813875194458, 66.66359982606707, 35.10084091995871, 33.331799913033535, 33.66848476063993, 1.7550420459979392], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764, 0.817906937597229, 0.817906937597229, 17.72769743432258, 17.72769743432258, 0.817906937597229, 0.817906937597229, 33.331799913033535, 33.331799913033535, 17.550420459979357, 17.550420459979357, 16.665899956516768, 16.665899956516768, 16.834242380319964, 16.834242380319964, 0.8775210229989696, 0.8775210229989696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36630560304396736, "mean_inference_ms": 1.3255810641754642, "mean_action_processing_ms": 0.07087498415543085, "mean_env_wait_ms": 0.468842766115411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 22.10850693509087, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 11.054253467545431}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353, 1.635813875194458, 35.45539486864516, 1.635813875194458, 66.66359982606707, 35.10084091995871, 33.331799913033535, 33.66848476063993, 1.7550420459979392], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764, 0.817906937597229, 0.817906937597229, 17.72769743432258, 17.72769743432258, 0.817906937597229, 0.817906937597229, 33.331799913033535, 33.331799913033535, 17.550420459979357, 17.550420459979357, 16.665899956516768, 16.665899956516768, 16.834242380319964, 16.834242380319964, 0.8775210229989696, 0.8775210229989696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36630560304396736, "mean_inference_ms": 1.3255810641754642, "mean_action_processing_ms": 0.07087498415543085, "mean_env_wait_ms": 0.468842766115411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 20000, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 1821.67, "learn_time_ms": 28.275, "learn_throughput": 28293.533}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 50, "training_iteration": 25, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-41-01", "timestamp": 1721659261, "time_this_iter_s": 1.991114854812622, "time_total_s": 60.8108344078064, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 60.8108344078064, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 2.2333333333333334, "ram_util_percent": 29.233333333333334, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.10075720566682951}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.98076923076923, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.3076923076923075, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.038461538461538, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.115384615384615, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.153846153846154, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.75, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.6923076923076925, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.0192307692307692, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.7884615384615384, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.9230769230769231, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8076923076923077, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.7115384615384617, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.6538461538461537, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.1346153846153846, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.23076923076923078, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.326923076923077, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.1153846153846154, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 0.9615384615384616, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.8653846153846154, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.3076923076923077, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.4807692307692308, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.1346153846153846, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.2692307692307692, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.21153846153846154, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.9230769230769231, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8076923076923077, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9230769230769231, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8076923076923077, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 4.999999873689376e-05, "total_loss": -0.33384770154953003, "policy_loss": -8.077360689640045e-06, "vf_loss": 3.4746339321136475, "vf_explained_var": 0.00032576918601989746, "kl": 3.846509244453955e-08, "entropy": 1.790287733078003, "entropy_coeff": 0.18666666746139526, "model": {}}}}, "num_env_steps_sampled": 20800, "num_env_steps_trained": 20800, "num_agent_steps_sampled": 41600, "num_agent_steps_trained": 41600}, "sampler_results": {"episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.97344109014571, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.986720545072853}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.98076923076923, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.3076923076923075, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.038461538461538, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.115384615384615, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.153846153846154, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.75, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.6923076923076925, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.0192307692307692, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.7884615384615384, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.9230769230769231, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8076923076923077, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.7115384615384617, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.6538461538461537, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.1346153846153846, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.23076923076923078, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.326923076923077, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.1153846153846154, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 0.9615384615384616, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.8653846153846154, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.3076923076923077, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.4807692307692308, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.0, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 0, "soup_delivery_agent_1_mean": 0.1346153846153846, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.2692307692307692, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.21153846153846154, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.9230769230769231, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8076923076923077, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9230769230769231, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8076923076923077, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353, 1.635813875194458, 35.45539486864516, 1.635813875194458, 66.66359982606707, 35.10084091995871, 33.331799913033535, 33.66848476063993, 1.7550420459979392, 3.861790020000001, 33.331799913033535], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764, 0.817906937597229, 0.817906937597229, 17.72769743432258, 17.72769743432258, 0.817906937597229, 0.817906937597229, 33.331799913033535, 33.331799913033535, 17.550420459979357, 17.550420459979357, 16.665899956516768, 16.665899956516768, 16.834242380319964, 16.834242380319964, 0.8775210229989696, 0.8775210229989696, 1.9308950100000004, 1.9308950100000004, 16.665899956516768, 16.665899956516768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36644844092845624, "mean_inference_ms": 1.3253218660647783, "mean_action_processing_ms": 0.07089309223147963, "mean_env_wait_ms": 0.4681113290565252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.97344109014571, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.986720545072853}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353, 1.635813875194458, 35.45539486864516, 1.635813875194458, 66.66359982606707, 35.10084091995871, 33.331799913033535, 33.66848476063993, 1.7550420459979392, 3.861790020000001, 33.331799913033535], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764, 0.817906937597229, 0.817906937597229, 17.72769743432258, 17.72769743432258, 0.817906937597229, 0.817906937597229, 33.331799913033535, 33.331799913033535, 17.550420459979357, 17.550420459979357, 16.665899956516768, 16.665899956516768, 16.834242380319964, 16.834242380319964, 0.8775210229989696, 0.8775210229989696, 1.9308950100000004, 1.9308950100000004, 16.665899956516768, 16.665899956516768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36644844092845624, "mean_inference_ms": 1.3253218660647783, "mean_action_processing_ms": 0.07089309223147963, "mean_env_wait_ms": 0.4681113290565252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 41600, "num_agent_steps_trained": 41600, "num_env_steps_sampled": 20800, "num_env_steps_trained": 20800, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 20800, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 41600, "timers": {"training_iteration_time_ms": 1835.61, "learn_time_ms": 28.935, "learn_throughput": 27648.356}, "counters": {"num_env_steps_sampled": 20800, "num_env_steps_trained": 20800, "num_agent_steps_sampled": 41600, "num_agent_steps_trained": 41600}, "done": false, "episodes_total": 52, "training_iteration": 26, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-41-05", "timestamp": 1721659265, "time_this_iter_s": 3.3185548782348633, "time_total_s": 64.12938928604126, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 64.12938928604126, "timesteps_since_restore": 0, "iterations_since_restore": 26, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 8.15, "ram_util_percent": 29.225, "gpu_util_percent0": 0.12250000000000001, "vram_util_percent0": 0.10051294577430386}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.907407407407407, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.2407407407407405, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.037037037037037, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.092592592592593, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.166666666666667, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.7037037037037037, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.7222222222222223, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.9814814814814815, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.7962962962962963, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.9074074074074074, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7962962962962963, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.7777777777777777, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.7222222222222223, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.14814814814814814, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.2222222222222222, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.3703703703703702, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.1666666666666665, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 0.9444444444444444, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.9074074074074074, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.3148148148148148, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.46296296296296297, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.018518518518518517, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.12962962962962962, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.25925925925925924, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.2037037037037037, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.9074074074074074, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7962962962962963, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9074074074074074, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7962962962962963, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 4.999999873689376e-05, "total_loss": -0.3330092430114746, "policy_loss": 4.237517714500427e-07, "vf_loss": 2.342020273208618, "vf_explained_var": -0.0002772212028503418, "kl": 7.314174155226283e-08, "entropy": 1.790350079536438, "entropy_coeff": 0.18613334000110626, "model": {}}}}, "num_env_steps_sampled": 21600, "num_env_steps_trained": 21600, "num_agent_steps_sampled": 43200, "num_agent_steps_trained": 43200}, "sampler_results": {"episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.63561853279566, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.817809266397829}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.907407407407407, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.2407407407407405, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.037037037037037, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 4.092592592592593, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.166666666666667, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.7037037037037037, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.7222222222222223, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.9814814814814815, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.7962962962962963, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.9074074074074074, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7962962962962963, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.7777777777777777, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.7222222222222223, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.14814814814814814, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.2222222222222222, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.3703703703703702, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.1666666666666665, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 0.9444444444444444, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.9074074074074074, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.3148148148148148, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.46296296296296297, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.018518518518518517, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.12962962962962962, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.25925925925925924, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.2037037037037037, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.9074074074074074, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7962962962962963, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.9074074074074074, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7962962962962963, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353, 1.635813875194458, 35.45539486864516, 1.635813875194458, 66.66359982606707, 35.10084091995871, 33.331799913033535, 33.66848476063993, 1.7550420459979392, 3.861790020000001, 33.331799913033535, 0.0, 25.70446408338873], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764, 0.817906937597229, 0.817906937597229, 17.72769743432258, 17.72769743432258, 0.817906937597229, 0.817906937597229, 33.331799913033535, 33.331799913033535, 17.550420459979357, 17.550420459979357, 16.665899956516768, 16.665899956516768, 16.834242380319964, 16.834242380319964, 0.8775210229989696, 0.8775210229989696, 1.9308950100000004, 1.9308950100000004, 16.665899956516768, 16.665899956516768, 0.0, 0.0, 12.852232041694364, 12.852232041694364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36662952597411286, "mean_inference_ms": 1.3254581175397817, "mean_action_processing_ms": 0.07093477412652621, "mean_env_wait_ms": 0.46746692935234485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.63561853279566, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.817809266397829}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353, 1.635813875194458, 35.45539486864516, 1.635813875194458, 66.66359982606707, 35.10084091995871, 33.331799913033535, 33.66848476063993, 1.7550420459979392, 3.861790020000001, 33.331799913033535, 0.0, 25.70446408338873], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764, 0.817906937597229, 0.817906937597229, 17.72769743432258, 17.72769743432258, 0.817906937597229, 0.817906937597229, 33.331799913033535, 33.331799913033535, 17.550420459979357, 17.550420459979357, 16.665899956516768, 16.665899956516768, 16.834242380319964, 16.834242380319964, 0.8775210229989696, 0.8775210229989696, 1.9308950100000004, 1.9308950100000004, 16.665899956516768, 16.665899956516768, 0.0, 0.0, 12.852232041694364, 12.852232041694364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36662952597411286, "mean_inference_ms": 1.3254581175397817, "mean_action_processing_ms": 0.07093477412652621, "mean_env_wait_ms": 0.46746692935234485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 43200, "num_agent_steps_trained": 43200, "num_env_steps_sampled": 21600, "num_env_steps_trained": 21600, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 21600, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 43200, "timers": {"training_iteration_time_ms": 1871.651, "learn_time_ms": 29.459, "learn_throughput": 27156.343}, "counters": {"num_env_steps_sampled": 21600, "num_env_steps_trained": 21600, "num_agent_steps_sampled": 43200, "num_agent_steps_trained": 43200}, "done": false, "episodes_total": 54, "training_iteration": 27, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-41-07", "timestamp": 1721659267, "time_this_iter_s": 2.101511240005493, "time_total_s": 66.23090052604675, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 66.23090052604675, "timesteps_since_restore": 0, "iterations_since_restore": 27, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 8.033333333333333, "ram_util_percent": 29.233333333333334, "gpu_util_percent0": 0.38666666666666666, "vram_util_percent0": 0.10087933561309233}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.875, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.125, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.017857142857143, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.982142857142857, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.178571428571429, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.607142857142857, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.7142857142857144, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.9642857142857143, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.7857142857142857, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.875, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8035714285714286, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.875, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.7142857142857144, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.14285714285714285, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.21428571428571427, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.482142857142857, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.142857142857143, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.0178571428571428, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.9107142857142857, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.30357142857142855, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.48214285714285715, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.017857142857142856, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.125, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.25, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.19642857142857142, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.875, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8035714285714286, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.875, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8035714285714286, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 4.999999873689376e-05, "total_loss": -0.3319314122200012, "policy_loss": 1.0892748832702637e-05, "vf_loss": 3.0422139167785645, "vf_explained_var": 0.0006885230541229248, "kl": 8.798328821058021e-08, "entropy": 1.7901216745376587, "entropy_coeff": 0.18559999763965607, "model": {}}}}, "num_env_steps_sampled": 22400, "num_env_steps_trained": 22400, "num_agent_steps_sampled": 44800, "num_agent_steps_trained": 44800}, "sampler_results": {"episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 22.135020862361525, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 11.067510431180763}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.875, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.125, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.017857142857143, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.982142857142857, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.178571428571429, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.607142857142857, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.7142857142857144, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.9642857142857143, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.7857142857142857, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.875, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.8035714285714286, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.875, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.7142857142857144, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.14285714285714285, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.21428571428571427, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.482142857142857, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.142857142857143, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.0178571428571428, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.9107142857142857, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.30357142857142855, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.48214285714285715, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.017857142857142856, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.125, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.25, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.19642857142857142, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.875, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.8035714285714286, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.875, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.8035714285714286, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353, 1.635813875194458, 35.45539486864516, 1.635813875194458, 66.66359982606707, 35.10084091995871, 33.331799913033535, 33.66848476063993, 1.7550420459979392, 3.861790020000001, 33.331799913033535, 0.0, 25.70446408338873, 35.62868476063993, 35.60908276063992], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764, 0.817906937597229, 0.817906937597229, 17.72769743432258, 17.72769743432258, 0.817906937597229, 0.817906937597229, 33.331799913033535, 33.331799913033535, 17.550420459979357, 17.550420459979357, 16.665899956516768, 16.665899956516768, 16.834242380319964, 16.834242380319964, 0.8775210229989696, 0.8775210229989696, 1.9308950100000004, 1.9308950100000004, 16.665899956516768, 16.665899956516768, 0.0, 0.0, 12.852232041694364, 12.852232041694364, 17.814342380319964, 17.814342380319964, 17.80454138031996, 17.80454138031996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.366825163347095, "mean_inference_ms": 1.325977754722637, "mean_action_processing_ms": 0.07099598419497546, "mean_env_wait_ms": 0.46695555948907125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 22.135020862361525, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 11.067510431180763}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353, 1.635813875194458, 35.45539486864516, 1.635813875194458, 66.66359982606707, 35.10084091995871, 33.331799913033535, 33.66848476063993, 1.7550420459979392, 3.861790020000001, 33.331799913033535, 0.0, 25.70446408338873, 35.62868476063993, 35.60908276063992], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764, 0.817906937597229, 0.817906937597229, 17.72769743432258, 17.72769743432258, 0.817906937597229, 0.817906937597229, 33.331799913033535, 33.331799913033535, 17.550420459979357, 17.550420459979357, 16.665899956516768, 16.665899956516768, 16.834242380319964, 16.834242380319964, 0.8775210229989696, 0.8775210229989696, 1.9308950100000004, 1.9308950100000004, 16.665899956516768, 16.665899956516768, 0.0, 0.0, 12.852232041694364, 12.852232041694364, 17.814342380319964, 17.814342380319964, 17.80454138031996, 17.80454138031996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.366825163347095, "mean_inference_ms": 1.325977754722637, "mean_action_processing_ms": 0.07099598419497546, "mean_env_wait_ms": 0.46695555948907125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 44800, "num_agent_steps_trained": 44800, "num_env_steps_sampled": 22400, "num_env_steps_trained": 22400, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 22400, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 44800, "timers": {"training_iteration_time_ms": 1890.519, "learn_time_ms": 29.795, "learn_throughput": 26850.076}, "counters": {"num_env_steps_sampled": 22400, "num_env_steps_trained": 22400, "num_agent_steps_sampled": 44800, "num_agent_steps_trained": 44800}, "done": false, "episodes_total": 56, "training_iteration": 28, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-41-10", "timestamp": 1721659270, "time_this_iter_s": 3.480607032775879, "time_total_s": 69.71150755882263, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 69.71150755882263, "timesteps_since_restore": 0, "iterations_since_restore": 28, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 6.7, "ram_util_percent": 29.259999999999998, "gpu_util_percent0": 0.038, "vram_util_percent0": 0.1003419638495359}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.89655172413793, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.0, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.0, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.8793103448275863, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.137931034482759, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.5, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.7241379310344827, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.9482758620689655, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.7931034482758621, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.8793103448275862, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7758620689655172, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.913793103448276, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.7586206896551726, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.13793103448275862, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.22413793103448276, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.4827586206896552, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.189655172413793, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.0517241379310345, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.9827586206896551, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.3275862068965517, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.46551724137931033, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.034482758620689655, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.1206896551724138, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.2413793103448276, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.1896551724137931, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.8793103448275862, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7758620689655172, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8793103448275862, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7758620689655172, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 4.999999873689376e-05, "total_loss": -0.33106207847595215, "policy_loss": 1.01606419775635e-05, "vf_loss": 2.4515976905822754, "vf_explained_var": 0.00021696090698242188, "kl": 6.905121097133815e-08, "entropy": 1.790259599685669, "entropy_coeff": 0.18506667017936707, "model": {}}}}, "num_env_steps_sampled": 23200, "num_env_steps_trained": 23200, "num_agent_steps_sampled": 46400, "num_agent_steps_trained": 46400}, "sampler_results": {"episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.979889072504808, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.989944536252406}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.89655172413793, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.0, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.0, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.8793103448275863, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.137931034482759, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.5, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.7241379310344827, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.9482758620689655, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.7931034482758621, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.8793103448275862, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7758620689655172, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.913793103448276, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.7586206896551726, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.13793103448275862, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.22413793103448276, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.4827586206896552, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.189655172413793, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.0517241379310345, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.9827586206896551, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.3275862068965517, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.46551724137931033, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.034482758620689655, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.1206896551724138, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.2413793103448276, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.1896551724137931, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.8793103448275862, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7758620689655172, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8793103448275862, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7758620689655172, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353, 1.635813875194458, 35.45539486864516, 1.635813875194458, 66.66359982606707, 35.10084091995871, 33.331799913033535, 33.66848476063993, 1.7550420459979392, 3.861790020000001, 33.331799913033535, 0.0, 25.70446408338873, 35.62868476063993, 35.60908276063992, 35.27239791303353, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764, 0.817906937597229, 0.817906937597229, 17.72769743432258, 17.72769743432258, 0.817906937597229, 0.817906937597229, 33.331799913033535, 33.331799913033535, 17.550420459979357, 17.550420459979357, 16.665899956516768, 16.665899956516768, 16.834242380319964, 16.834242380319964, 0.8775210229989696, 0.8775210229989696, 1.9308950100000004, 1.9308950100000004, 16.665899956516768, 16.665899956516768, 0.0, 0.0, 12.852232041694364, 12.852232041694364, 17.814342380319964, 17.814342380319964, 17.80454138031996, 17.80454138031996, 17.636198956516765, 17.636198956516765, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3669533136302863, "mean_inference_ms": 1.3263745505005775, "mean_action_processing_ms": 0.07104708480418534, "mean_env_wait_ms": 0.46641417441662236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.979889072504808, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.989944536252406}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353, 1.635813875194458, 35.45539486864516, 1.635813875194458, 66.66359982606707, 35.10084091995871, 33.331799913033535, 33.66848476063993, 1.7550420459979392, 3.861790020000001, 33.331799913033535, 0.0, 25.70446408338873, 35.62868476063993, 35.60908276063992, 35.27239791303353, 0.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764, 0.817906937597229, 0.817906937597229, 17.72769743432258, 17.72769743432258, 0.817906937597229, 0.817906937597229, 33.331799913033535, 33.331799913033535, 17.550420459979357, 17.550420459979357, 16.665899956516768, 16.665899956516768, 16.834242380319964, 16.834242380319964, 0.8775210229989696, 0.8775210229989696, 1.9308950100000004, 1.9308950100000004, 16.665899956516768, 16.665899956516768, 0.0, 0.0, 12.852232041694364, 12.852232041694364, 17.814342380319964, 17.814342380319964, 17.80454138031996, 17.80454138031996, 17.636198956516765, 17.636198956516765, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3669533136302863, "mean_inference_ms": 1.3263745505005775, "mean_action_processing_ms": 0.07104708480418534, "mean_env_wait_ms": 0.46641417441662236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 46400, "num_agent_steps_trained": 46400, "num_env_steps_sampled": 23200, "num_env_steps_trained": 23200, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 23200, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 46400, "timers": {"training_iteration_time_ms": 1873.372, "learn_time_ms": 29.586, "learn_throughput": 27039.811}, "counters": {"num_env_steps_sampled": 23200, "num_env_steps_trained": 23200, "num_agent_steps_sampled": 46400, "num_agent_steps_trained": 46400}, "done": false, "episodes_total": 58, "training_iteration": 29, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-41-12", "timestamp": 1721659272, "time_this_iter_s": 1.696202278137207, "time_total_s": 71.40770983695984, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 71.40770983695984, "timesteps_since_restore": 0, "iterations_since_restore": 29, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 9.65, "ram_util_percent": 29.2, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.10039081582804103}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.8, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.05, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 4.966666666666667, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.8666666666666667, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.05, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.566666666666667, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.7, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.0333333333333334, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.85, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.8666666666666667, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7666666666666667, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.9, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.7666666666666666, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.15, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.23333333333333334, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.466666666666667, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.2, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.0166666666666666, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.95, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.31666666666666665, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.45, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.03333333333333333, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.11666666666666667, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.23333333333333334, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.18333333333333332, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.8666666666666667, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7666666666666667, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8666666666666667, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7666666666666667, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 4.999999873689376e-05, "total_loss": -0.3302565813064575, "policy_loss": -3.994908183813095e-06, "vf_loss": 0.6539368629455566, "vf_explained_var": -0.0008406639099121094, "kl": 7.608628749267154e-08, "entropy": 1.790018081665039, "entropy_coeff": 0.18453332781791687, "model": {}}}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.30572750495458, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.65286375247729}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.8, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.05, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 4.966666666666667, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.8666666666666667, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.05, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.566666666666667, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.7, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.0333333333333334, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.85, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.8666666666666667, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7666666666666667, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.9, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.7666666666666666, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.15, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.23333333333333334, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.466666666666667, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.2, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.0166666666666666, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.95, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.31666666666666665, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.45, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.03333333333333333, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.11666666666666667, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.23333333333333334, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.18333333333333332, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.8666666666666667, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7666666666666667, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8666666666666667, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7666666666666667, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353, 1.635813875194458, 35.45539486864516, 1.635813875194458, 66.66359982606707, 35.10084091995871, 33.331799913033535, 33.66848476063993, 1.7550420459979392, 3.861790020000001, 33.331799913033535, 0.0, 25.70446408338873, 35.62868476063993, 35.60908276063992, 35.27239791303353, 0.0, 1.7550420459979392, 1.7550420459979392], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764, 0.817906937597229, 0.817906937597229, 17.72769743432258, 17.72769743432258, 0.817906937597229, 0.817906937597229, 33.331799913033535, 33.331799913033535, 17.550420459979357, 17.550420459979357, 16.665899956516768, 16.665899956516768, 16.834242380319964, 16.834242380319964, 0.8775210229989696, 0.8775210229989696, 1.9308950100000004, 1.9308950100000004, 16.665899956516768, 16.665899956516768, 0.0, 0.0, 12.852232041694364, 12.852232041694364, 17.814342380319964, 17.814342380319964, 17.80454138031996, 17.80454138031996, 17.636198956516765, 17.636198956516765, 0.0, 0.0, 0.8775210229989696, 0.8775210229989696, 0.8775210229989696, 0.8775210229989696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3670328129328508, "mean_inference_ms": 1.3266257920866875, "mean_action_processing_ms": 0.07108743357318024, "mean_env_wait_ms": 0.465905245673062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.30572750495458, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.65286375247729}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353, 1.635813875194458, 35.45539486864516, 1.635813875194458, 66.66359982606707, 35.10084091995871, 33.331799913033535, 33.66848476063993, 1.7550420459979392, 3.861790020000001, 33.331799913033535, 0.0, 25.70446408338873, 35.62868476063993, 35.60908276063992, 35.27239791303353, 0.0, 1.7550420459979392, 1.7550420459979392], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764, 0.817906937597229, 0.817906937597229, 17.72769743432258, 17.72769743432258, 0.817906937597229, 0.817906937597229, 33.331799913033535, 33.331799913033535, 17.550420459979357, 17.550420459979357, 16.665899956516768, 16.665899956516768, 16.834242380319964, 16.834242380319964, 0.8775210229989696, 0.8775210229989696, 1.9308950100000004, 1.9308950100000004, 16.665899956516768, 16.665899956516768, 0.0, 0.0, 12.852232041694364, 12.852232041694364, 17.814342380319964, 17.814342380319964, 17.80454138031996, 17.80454138031996, 17.636198956516765, 17.636198956516765, 0.0, 0.0, 0.8775210229989696, 0.8775210229989696, 0.8775210229989696, 0.8775210229989696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3670328129328508, "mean_inference_ms": 1.3266257920866875, "mean_action_processing_ms": 0.07108743357318024, "mean_env_wait_ms": 0.465905245673062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 24000, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 1875.874, "learn_time_ms": 29.9, "learn_throughput": 26755.851}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 60, "training_iteration": 30, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-41-15", "timestamp": 1721659275, "time_this_iter_s": 2.9135560989379883, "time_total_s": 74.32126593589783, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 74.32126593589783, "timesteps_since_restore": 0, "iterations_since_restore": 30, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 5.85, "ram_util_percent": 29.25, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.10039081582804103}}
{"custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.709677419354838, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.032258064516129, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 4.919354838709677, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.8548387096774195, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.0, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.564516129032258, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.661290322580645, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.0161290322580645, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.8548387096774194, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.8709677419354839, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7741935483870968, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.8870967741935485, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.8870967741935485, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.14516129032258066, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.22580645161290322, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.4516129032258065, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.3225806451612905, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.0161290322580645, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.0, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.3064516129032258, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.43548387096774194, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.03225806451612903, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.11290322580645161, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.22580645161290322, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.1774193548387097, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.8709677419354839, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7741935483870968, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8709677419354839, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7741935483870968, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 4.999999873689376e-05, "total_loss": -0.32927775382995605, "policy_loss": -5.736947059631348e-06, "vf_loss": 1.7497520446777344, "vf_explained_var": 0.0006097257137298584, "kl": 9.540301704191734e-08, "entropy": 1.7904727458953857, "entropy_coeff": 0.18400000035762787, "model": {}}}}, "num_env_steps_sampled": 24800, "num_env_steps_trained": 24800, "num_agent_steps_sampled": 49600, "num_agent_steps_trained": 49600}, "sampler_results": {"episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.07431776903333, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.537158884516662}, "custom_metrics": {"sparse_reward_mean": 0.0, "sparse_reward_min": 0, "sparse_reward_max": 0, "shaped_reward_mean": 8.709677419354838, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.032258064516129, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 4.919354838709677, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.8548387096774195, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.0, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.564516129032258, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.661290322580645, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 1.0161290322580645, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.8548387096774194, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.8709677419354839, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.7741935483870968, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 3, "dish_pickup_agent_0_mean": 2.8870967741935485, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.8870967741935485, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.14516129032258066, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.22580645161290322, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.4516129032258065, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.3225806451612905, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.0161290322580645, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 1.0, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.3064516129032258, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.43548387096774194, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.03225806451612903, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.11290322580645161, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.22580645161290322, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.1774193548387097, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.8709677419354839, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.7741935483870968, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 3, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.8709677419354839, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.7741935483870968, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 3, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353, 1.635813875194458, 35.45539486864516, 1.635813875194458, 66.66359982606707, 35.10084091995871, 33.331799913033535, 33.66848476063993, 1.7550420459979392, 3.861790020000001, 33.331799913033535, 0.0, 25.70446408338873, 35.62868476063993, 35.60908276063992, 35.27239791303353, 0.0, 1.7550420459979392, 1.7550420459979392, 1.7727697434322565, 26.491281639359343], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764, 0.817906937597229, 0.817906937597229, 17.72769743432258, 17.72769743432258, 0.817906937597229, 0.817906937597229, 33.331799913033535, 33.331799913033535, 17.550420459979357, 17.550420459979357, 16.665899956516768, 16.665899956516768, 16.834242380319964, 16.834242380319964, 0.8775210229989696, 0.8775210229989696, 1.9308950100000004, 1.9308950100000004, 16.665899956516768, 16.665899956516768, 0.0, 0.0, 12.852232041694364, 12.852232041694364, 17.814342380319964, 17.814342380319964, 17.80454138031996, 17.80454138031996, 17.636198956516765, 17.636198956516765, 0.0, 0.0, 0.8775210229989696, 0.8775210229989696, 0.8775210229989696, 0.8775210229989696, 0.8863848717161282, 0.8863848717161282, 13.245640819679672, 13.245640819679672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36707570549256624, "mean_inference_ms": 1.326769427424518, "mean_action_processing_ms": 0.07111903783985309, "mean_env_wait_ms": 0.4653771997730657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.07431776903333, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.537158884516662}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353, 1.635813875194458, 35.45539486864516, 1.635813875194458, 66.66359982606707, 35.10084091995871, 33.331799913033535, 33.66848476063993, 1.7550420459979392, 3.861790020000001, 33.331799913033535, 0.0, 25.70446408338873, 35.62868476063993, 35.60908276063992, 35.27239791303353, 0.0, 1.7550420459979392, 1.7550420459979392, 1.7727697434322565, 26.491281639359343], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764, 0.817906937597229, 0.817906937597229, 17.72769743432258, 17.72769743432258, 0.817906937597229, 0.817906937597229, 33.331799913033535, 33.331799913033535, 17.550420459979357, 17.550420459979357, 16.665899956516768, 16.665899956516768, 16.834242380319964, 16.834242380319964, 0.8775210229989696, 0.8775210229989696, 1.9308950100000004, 1.9308950100000004, 16.665899956516768, 16.665899956516768, 0.0, 0.0, 12.852232041694364, 12.852232041694364, 17.814342380319964, 17.814342380319964, 17.80454138031996, 17.80454138031996, 17.636198956516765, 17.636198956516765, 0.0, 0.0, 0.8775210229989696, 0.8775210229989696, 0.8775210229989696, 0.8775210229989696, 0.8863848717161282, 0.8863848717161282, 13.245640819679672, 13.245640819679672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36707570549256624, "mean_inference_ms": 1.326769427424518, "mean_action_processing_ms": 0.07111903783985309, "mean_env_wait_ms": 0.4653771997730657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 49600, "num_agent_steps_trained": 49600, "num_env_steps_sampled": 24800, "num_env_steps_trained": 24800, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 24800, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 49600, "timers": {"training_iteration_time_ms": 1871.434, "learn_time_ms": 30.03, "learn_throughput": 26640.227}, "counters": {"num_env_steps_sampled": 24800, "num_env_steps_trained": 24800, "num_agent_steps_sampled": 49600, "num_agent_steps_trained": 49600}, "done": false, "episodes_total": 62, "training_iteration": 31, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-41-17", "timestamp": 1721659277, "time_this_iter_s": 1.6911368370056152, "time_total_s": 76.01240277290344, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 76.01240277290344, "timesteps_since_restore": 0, "iterations_since_restore": 31, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 13.95, "ram_util_percent": 29.25, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.10039081582804103}}
{"evaluation": {"average_sparse_reward": 0.0, "num_healthy_workers": 0, "num_recreated_workers": 0}, "custom_metrics": {"sparse_reward_mean": 0.3125, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 8.96875, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.09375, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.015625, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.953125, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.125, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.609375, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.703125, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.984375, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.828125, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.875, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.84375, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.859375, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.859375, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.140625, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.21875, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.4375, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.265625, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.03125, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.96875, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.296875, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.46875, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.03125, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.140625, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.21875, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.1875, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.875, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.84375, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.875, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.84375, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"ppo": {"learner_stats": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 4.999999873689376e-05, "total_loss": -0.32802629470825195, "policy_loss": -1.0998919606208801e-05, "vf_loss": 4.506232261657715, "vf_explained_var": -0.0005172491073608398, "kl": 1.1121274923198143e-07, "entropy": 1.790330171585083, "entropy_coeff": 0.18346667289733887, "model": {}}}}, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200}, "sampler_results": {"episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.51226363776494, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.75613181888247}, "custom_metrics": {"sparse_reward_mean": 0.3125, "sparse_reward_min": 0, "sparse_reward_max": 20, "shaped_reward_mean": 8.96875, "shaped_reward_min": 0, "shaped_reward_max": 23, "tomato_pickup_agent_0_mean": 0.0, "tomato_pickup_agent_0_min": 0, "tomato_pickup_agent_0_max": 0, "tomato_pickup_agent_1_mean": 0.0, "tomato_pickup_agent_1_min": 0, "tomato_pickup_agent_1_max": 0, "useful_tomato_pickup_agent_0_mean": 0.0, "useful_tomato_pickup_agent_0_min": 0, "useful_tomato_pickup_agent_0_max": 0, "useful_tomato_pickup_agent_1_mean": 0.0, "useful_tomato_pickup_agent_1_min": 0, "useful_tomato_pickup_agent_1_max": 0, "tomato_drop_agent_0_mean": 0.0, "tomato_drop_agent_0_min": 0, "tomato_drop_agent_0_max": 0, "tomato_drop_agent_1_mean": 0.0, "tomato_drop_agent_1_min": 0, "tomato_drop_agent_1_max": 0, "useful_tomato_drop_agent_0_mean": 0.0, "useful_tomato_drop_agent_0_min": 0, "useful_tomato_drop_agent_0_max": 0, "useful_tomato_drop_agent_1_mean": 0.0, "useful_tomato_drop_agent_1_min": 0, "useful_tomato_drop_agent_1_max": 0, "potting_tomato_agent_0_mean": 0.0, "potting_tomato_agent_0_min": 0, "potting_tomato_agent_0_max": 0, "potting_tomato_agent_1_mean": 0.0, "potting_tomato_agent_1_min": 0, "potting_tomato_agent_1_max": 0, "onion_pickup_agent_0_mean": 5.09375, "onion_pickup_agent_0_min": 0, "onion_pickup_agent_0_max": 15, "onion_pickup_agent_1_mean": 5.015625, "onion_pickup_agent_1_min": 1, "onion_pickup_agent_1_max": 12, "useful_onion_pickup_agent_0_mean": 3.953125, "useful_onion_pickup_agent_0_min": 0, "useful_onion_pickup_agent_0_max": 15, "useful_onion_pickup_agent_1_mean": 4.125, "useful_onion_pickup_agent_1_min": 1, "useful_onion_pickup_agent_1_max": 12, "onion_drop_agent_0_mean": 3.609375, "onion_drop_agent_0_min": 0, "onion_drop_agent_0_max": 12, "onion_drop_agent_1_mean": 3.703125, "onion_drop_agent_1_min": 0, "onion_drop_agent_1_max": 9, "useful_onion_drop_agent_0_mean": 0.984375, "useful_onion_drop_agent_0_min": 0, "useful_onion_drop_agent_0_max": 6, "useful_onion_drop_agent_1_mean": 0.828125, "useful_onion_drop_agent_1_min": 0, "useful_onion_drop_agent_1_max": 4, "potting_onion_agent_0_mean": 0.875, "potting_onion_agent_0_min": 0, "potting_onion_agent_0_max": 3, "potting_onion_agent_1_mean": 0.84375, "potting_onion_agent_1_min": 0, "potting_onion_agent_1_max": 4, "dish_pickup_agent_0_mean": 2.859375, "dish_pickup_agent_0_min": 0, "dish_pickup_agent_0_max": 12, "dish_pickup_agent_1_mean": 2.859375, "dish_pickup_agent_1_min": 0, "dish_pickup_agent_1_max": 7, "useful_dish_pickup_agent_0_mean": 0.140625, "useful_dish_pickup_agent_0_min": 0, "useful_dish_pickup_agent_0_max": 1, "useful_dish_pickup_agent_1_mean": 0.21875, "useful_dish_pickup_agent_1_min": 0, "useful_dish_pickup_agent_1_max": 2, "dish_drop_agent_0_mean": 2.4375, "dish_drop_agent_0_min": 0, "dish_drop_agent_0_max": 11, "dish_drop_agent_1_mean": 2.265625, "dish_drop_agent_1_min": 0, "dish_drop_agent_1_max": 7, "useful_dish_drop_agent_0_mean": 1.03125, "useful_dish_drop_agent_0_min": 0, "useful_dish_drop_agent_0_max": 5, "useful_dish_drop_agent_1_mean": 0.96875, "useful_dish_drop_agent_1_min": 0, "useful_dish_drop_agent_1_max": 4, "soup_pickup_agent_0_mean": 0.296875, "soup_pickup_agent_0_min": 0, "soup_pickup_agent_0_max": 4, "soup_pickup_agent_1_mean": 0.46875, "soup_pickup_agent_1_min": 0, "soup_pickup_agent_1_max": 3, "soup_delivery_agent_0_mean": 0.03125, "soup_delivery_agent_0_min": 0, "soup_delivery_agent_0_max": 1, "soup_delivery_agent_1_mean": 0.140625, "soup_delivery_agent_1_min": 0, "soup_delivery_agent_1_max": 1, "soup_drop_agent_0_mean": 0.21875, "soup_drop_agent_0_min": 0, "soup_drop_agent_0_max": 4, "soup_drop_agent_1_mean": 0.1875, "soup_drop_agent_1_min": 0, "soup_drop_agent_1_max": 3, "optimal_onion_potting_agent_0_mean": 0.875, "optimal_onion_potting_agent_0_min": 0, "optimal_onion_potting_agent_0_max": 3, "optimal_onion_potting_agent_1_mean": 0.84375, "optimal_onion_potting_agent_1_min": 0, "optimal_onion_potting_agent_1_max": 4, "optimal_tomato_potting_agent_0_mean": 0.0, "optimal_tomato_potting_agent_0_min": 0, "optimal_tomato_potting_agent_0_max": 0, "optimal_tomato_potting_agent_1_mean": 0.0, "optimal_tomato_potting_agent_1_min": 0, "optimal_tomato_potting_agent_1_max": 0, "viable_onion_potting_agent_0_mean": 0.875, "viable_onion_potting_agent_0_min": 0, "viable_onion_potting_agent_0_max": 3, "viable_onion_potting_agent_1_mean": 0.84375, "viable_onion_potting_agent_1_min": 0, "viable_onion_potting_agent_1_max": 4, "viable_tomato_potting_agent_0_mean": 0.0, "viable_tomato_potting_agent_0_min": 0, "viable_tomato_potting_agent_0_max": 0, "viable_tomato_potting_agent_1_mean": 0.0, "viable_tomato_potting_agent_1_min": 0, "viable_tomato_potting_agent_1_max": 0, "catastrophic_onion_potting_agent_0_mean": 0.0, "catastrophic_onion_potting_agent_0_min": 0, "catastrophic_onion_potting_agent_0_max": 0, "catastrophic_onion_potting_agent_1_mean": 0.0, "catastrophic_onion_potting_agent_1_min": 0, "catastrophic_onion_potting_agent_1_max": 0, "catastrophic_tomato_potting_agent_0_mean": 0.0, "catastrophic_tomato_potting_agent_0_min": 0, "catastrophic_tomato_potting_agent_0_max": 0, "catastrophic_tomato_potting_agent_1_mean": 0.0, "catastrophic_tomato_potting_agent_1_min": 0, "catastrophic_tomato_potting_agent_1_max": 0, "useless_onion_potting_agent_0_mean": 0.0, "useless_onion_potting_agent_0_min": 0, "useless_onion_potting_agent_0_max": 0, "useless_onion_potting_agent_1_mean": 0.0, "useless_onion_potting_agent_1_min": 0, "useless_onion_potting_agent_1_max": 0, "useless_tomato_potting_agent_0_mean": 0.0, "useless_tomato_potting_agent_0_min": 0, "useless_tomato_potting_agent_0_max": 0, "useless_tomato_potting_agent_1_mean": 0.0, "useless_tomato_potting_agent_1_min": 0, "useless_tomato_potting_agent_1_max": 0}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353, 1.635813875194458, 35.45539486864516, 1.635813875194458, 66.66359982606707, 35.10084091995871, 33.331799913033535, 33.66848476063993, 1.7550420459979392, 3.861790020000001, 33.331799913033535, 0.0, 25.70446408338873, 35.62868476063993, 35.60908276063992, 35.27239791303353, 0.0, 1.7550420459979392, 1.7550420459979392, 1.7727697434322565, 26.491281639359343, 28.422129090891687, 41.75504204599791], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764, 0.817906937597229, 0.817906937597229, 17.72769743432258, 17.72769743432258, 0.817906937597229, 0.817906937597229, 33.331799913033535, 33.331799913033535, 17.550420459979357, 17.550420459979357, 16.665899956516768, 16.665899956516768, 16.834242380319964, 16.834242380319964, 0.8775210229989696, 0.8775210229989696, 1.9308950100000004, 1.9308950100000004, 16.665899956516768, 16.665899956516768, 0.0, 0.0, 12.852232041694364, 12.852232041694364, 17.814342380319964, 17.814342380319964, 17.80454138031996, 17.80454138031996, 17.636198956516765, 17.636198956516765, 0.0, 0.0, 0.8775210229989696, 0.8775210229989696, 0.8775210229989696, 0.8775210229989696, 0.8863848717161282, 0.8863848717161282, 13.245640819679672, 13.245640819679672, 14.211064545445844, 14.211064545445844, 20.87752102299897, 20.87752102299897]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36708540123443584, "mean_inference_ms": 1.3268616424007738, "mean_action_processing_ms": 0.07114534002900777, "mean_env_wait_ms": 0.46499759289051557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": 72.48044476063993, "episode_reward_min": 0.0, "episode_reward_mean": 21.51226363776494, "episode_len_mean": 400.0, "episodes_this_iter": 2, "policy_reward_min": {"ppo": 0.0}, "policy_reward_max": {"ppo": 36.24022238031996}, "policy_reward_mean": {"ppo": 10.75613181888247}, "hist_stats": {"episode_reward": [28.709221303931002, 28.422129090891687, 1.4943441886631916, 33.331799913033535, 1.635813875194458, 1.635813875194458, 67.00028467367346, 35.311799913033525, 1.635813875194458, 32.71627750388923, 1.7727697434322565, 1.7550420459979392, 28.422129090891687, 0.0, 32.71627750388923, 1.9405980000000014, 35.45539486864516, 25.70446408338873, 27.57796343476312, 1.635813875194458, 33.66848476063993, 35.27239791303353, 1.635813875194458, 33.331799913033535, 28.412473659359335, 1.635813875194458, 1.635813875194458, 1.635813875194458, 23.95824025864644, 27.645062083388723, 72.48044476063993, 25.70446408338873, 25.964105134736087, 25.70446408338873, 33.331799913033535, 1.635813875194458, 67.00028467367346, 1.635813875194458, 1.635813875194458, 26.491281639359343, 1.635813875194458, 35.25299193303353, 1.635813875194458, 35.45539486864516, 1.635813875194458, 66.66359982606707, 35.10084091995871, 33.331799913033535, 33.66848476063993, 1.7550420459979392, 3.861790020000001, 33.331799913033535, 0.0, 25.70446408338873, 35.62868476063993, 35.60908276063992, 35.27239791303353, 0.0, 1.7550420459979392, 1.7550420459979392, 1.7727697434322565, 26.491281639359343, 28.422129090891687, 41.75504204599791], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_ppo_reward": [14.354610651965501, 14.354610651965501, 14.211064545445844, 14.211064545445844, 0.7471720943315958, 0.7471720943315958, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 17.655899956516762, 17.655899956516762, 0.817906937597229, 0.817906937597229, 16.358138751944615, 16.358138751944615, 0.8863848717161282, 0.8863848717161282, 0.8775210229989696, 0.8775210229989696, 14.211064545445844, 14.211064545445844, 0.0, 0.0, 16.358138751944615, 16.358138751944615, 0.9702990000000007, 0.9702990000000007, 17.72769743432258, 17.72769743432258, 12.852232041694364, 12.852232041694364, 13.78898171738156, 13.78898171738156, 0.817906937597229, 0.817906937597229, 16.834242380319964, 16.834242380319964, 17.636198956516765, 17.636198956516765, 0.817906937597229, 0.817906937597229, 16.665899956516768, 16.665899956516768, 14.206236829679668, 14.206236829679668, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 11.97912012932322, 11.97912012932322, 13.822531041694361, 13.822531041694361, 36.24022238031996, 36.24022238031996, 12.852232041694364, 12.852232041694364, 12.982052567368044, 12.982052567368044, 12.852232041694364, 12.852232041694364, 16.665899956516768, 16.665899956516768, 0.817906937597229, 0.817906937597229, 33.50014233683673, 33.50014233683673, 0.817906937597229, 0.817906937597229, 0.817906937597229, 0.817906937597229, 13.245640819679672, 13.245640819679672, 0.817906937597229, 0.817906937597229, 17.626495966516764, 17.626495966516764, 0.817906937597229, 0.817906937597229, 17.72769743432258, 17.72769743432258, 0.817906937597229, 0.817906937597229, 33.331799913033535, 33.331799913033535, 17.550420459979357, 17.550420459979357, 16.665899956516768, 16.665899956516768, 16.834242380319964, 16.834242380319964, 0.8775210229989696, 0.8775210229989696, 1.9308950100000004, 1.9308950100000004, 16.665899956516768, 16.665899956516768, 0.0, 0.0, 12.852232041694364, 12.852232041694364, 17.814342380319964, 17.814342380319964, 17.80454138031996, 17.80454138031996, 17.636198956516765, 17.636198956516765, 0.0, 0.0, 0.8775210229989696, 0.8775210229989696, 0.8775210229989696, 0.8775210229989696, 0.8863848717161282, 0.8863848717161282, 13.245640819679672, 13.245640819679672, 14.211064545445844, 14.211064545445844, 20.87752102299897, 20.87752102299897]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36708540123443584, "mean_inference_ms": 1.3268616424007738, "mean_action_processing_ms": 0.07114534002900777, "mean_env_wait_ms": 0.46499759289051557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 0, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 800, "timesteps_total": 25600, "num_steps_trained_this_iter": 800, "agent_timesteps_total": 51200, "timers": {"training_iteration_time_ms": 1886.011, "learn_time_ms": 29.788, "learn_throughput": 26856.222}, "counters": {"num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200}, "done": false, "episodes_total": 64, "training_iteration": 32, "trial_id": "default", "experiment_id": "04121ae7ba094e6e89dbec7bd2ffe192", "date": "2024-07-22_15-41-20", "timestamp": 1721659280, "time_this_iter_s": 3.0711286067962646, "time_total_s": 79.0835313796997, "pid": 44720, "hostname": "RiceLaptop", "node_ip": "172.19.175.88", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 400, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "overcooked_multi_agent", "env_config": {"mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}, "env_params": {"horizon": 400, "mlam_params": {"start_orientations": false, "wait_allowed": false, "counter_goals": [], "counter_drop": [], "counter_pickup": [], "same_motion_goals": true}}, "multi_agent_params": {"reward_shaping_factor": 1.0, "reward_shaping_horizon": Infinity, "use_phi": true, "bc_schedule": [[0, 0], [Infinity, 0]]}, "outer_shape": null, "eval_mdp_params": {"layout_name": "cramped_room", "rew_shaping_params": {"PLACEMENT_IN_POT_REW": 3, "DISH_PICKUP_REWARD": 3, "SOUP_PICKUP_REWARD": 5, "DISH_DISP_DISTANCE_REW": 0, "POT_DISTANCE_REW": 0, "SOUP_DISTANCE_REW": 0}, "old_dynamics": false}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 0, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 1, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.9, "lr": 5e-05, "train_batch_size": 800, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": 2, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": true, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6050>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 800, "num_sgd_iter": 1, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": [[0, 0.2], [300000.0, 0.1]], "clip_param": 0.2, "vf_clip_param": 10.0, "grad_clip": 0.1, "kl_target": 0.01, "vf_share_layers": true, "lambda": 0.98, "input": "sampler", "multiagent": {"policies": {"ppo": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0da19e6c90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function gen_trainer_from_params.<locals>.select_policy at 0x7f0e225d0680>", "policies_to_train": "{'ppo'}", "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'human_aware_rl.rllib.rllib.TrainingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": "<function get_rllib_eval_function.<locals>._evaluate at 0x7f0e225d0710>", "framework": "tf", "num_cpus_for_driver": 1}, "time_since_restore": 79.0835313796997, "timesteps_since_restore": 0, "iterations_since_restore": 32, "warmup_time": 1.522306203842163, "perf": {"cpu_util_percent": 7.425, "ram_util_percent": 29.225, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.10039081582804103}}
